<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Void ‚ú¶ –°–æ—Ü–∏–∞–ª—å–Ω–∞—è —Å–µ—Ç—å</title>
    <style>
        * {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
    -webkit-tap-highlight-color: transparent;
}

body {
    font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
    background: linear-gradient(135deg, #0a0a0a 0%, #1a1a1a 100%);
    color: #ffffff;
    line-height: 1.5;
    transition: all 0.3s ease;
    min-height: 100vh;
    position: relative;
    overflow-x: hidden;
}

body::before {
    content: '';
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: radial-gradient(circle at 50% 50%, rgba(102, 126, 234, 0.15) 0%, transparent 70%);
    pointer-events: none;
    z-index: -1;
    animation: pulseGlow 10s ease infinite;
}

@keyframes pulseGlow {
    0%, 100% { opacity: 0.3; transform: scale(1); }
    50% { opacity: 0.8; transform: scale(1.1); }
}

/* –°–≤–µ—Ç–ª–∞—è —Ç–µ–º–∞ */
body.light-theme {
    background: linear-gradient(135deg, #f0f2f5 0%, #e0e5ec 100%);
    color: #1a1a1a;
}

body.light-theme::before {
    background: radial-gradient(circle at 50% 50%, rgba(102, 126, 234, 0.2) 0%, transparent 70%);
}

body.light-theme .navbar {
    background: rgba(255, 255, 255, 0.9);
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
}

body.light-theme .nav-icon {
    color: #333;
}

body.light-theme .user-name {
    color: #333 !important;
}

body.light-theme .profile-section,
body.light-theme .create-post,
body.light-theme .post,
body.light-theme .edit-profile-form,
body.light-theme .modal-content {
    background: rgba(255, 255, 255, 0.95);
    border: 1px solid rgba(0, 0, 0, 0.1);
    box-shadow: 0 8px 30px rgba(0, 0, 0, 0.08);
}

body.light-theme .profile-name {
    background: linear-gradient(135deg, #333, #555);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
}

body.light-theme .profile-username,
body.light-theme .post-username,
body.light-theme .post-time,
body.light-theme .stat-label {
    color: #666;
}

body.light-theme .post-time {
    background: rgba(0, 0, 0, 0.05);
}

body.light-theme .post-content {
    color: #1a1a1a;
}

body.light-theme .edit-profile-btn {
    background: rgba(102, 126, 234, 0.1);
    border: 1px solid rgba(102, 126, 234, 0.3);
    color: #333;
}

body.light-theme .edit-profile-btn:hover {
    background: rgba(102, 126, 234, 0.2);
}

body.light-theme .create-post textarea,
body.light-theme .edit-profile-form input,
body.light-theme .edit-profile-form textarea,
body.light-theme .add-comment input {
    background: rgba(0, 0, 0, 0.03);
    border: 1px solid rgba(0, 0, 0, 0.1);
    color: #333;
}

body.light-theme .create-post textarea:focus,
body.light-theme .edit-profile-form input:focus,
body.light-theme .edit-profile-form textarea:focus,
body.light-theme .add-comment input:focus {
    border-color: #667eea;
    background: rgba(255, 255, 255, 0.9);
}

body.light-theme .tool-btn,
body.light-theme .follow-btn,
body.light-theme .comment-like-btn,
body.light-theme .refresh-btn {
    background: rgba(0, 0, 0, 0.03);
    border: 1px solid rgba(0, 0, 0, 0.1);
    color: #555;
}

body.light-theme .tool-btn:hover,
body.light-theme .follow-btn:hover,
body.light-theme .comment-like-btn:hover,
body.light-theme .refresh-btn:hover {
    background: rgba(102, 126, 234, 0.1);
}

body.light-theme .post-like-btn {
    background: rgba(0, 0, 0, 0.03);
    border: 1px solid rgba(0, 0, 0, 0.1);
    color: #555;
}

body.light-theme .post-like-btn.liked {
    background: linear-gradient(135deg, #667eea, #764ba2);
    color: white;
}

body.light-theme .comment-content {
    background: rgba(0, 0, 0, 0.03);
}

body.light-theme .post-actions,
body.light-theme .comments-section {
    border-top-color: rgba(0, 0, 0, 0.1);
}

body.light-theme .delete-btn,
body.light-theme .comment-delete-btn {
    color: #ff4757;
}

body.light-theme .bottom-nav {
    background: rgba(255, 255, 255, 0.9);
    border-top: 1px solid rgba(0, 0, 0, 0.1);
}

body.light-theme .nav-item {
    color: #666;
}

body.light-theme .nav-item.active {
    color: #667eea;
    background: rgba(102, 126, 234, 0.1);
}

body.light-theme .empty-state {
    color: #888;
    background: rgba(0, 0, 0, 0.02);
    border: 1px dashed rgba(0, 0, 0, 0.1);
}

body.light-theme .avatar-action-btn {
    background: rgba(0, 0, 0, 0.03);
    border: 1px solid rgba(0, 0, 0, 0.1);
    color: #555;
}

body.light-theme .avatar-action-btn.delete {
    color: #ff4757;
    border-color: rgba(255,68,68,0.3);
}

body.light-theme .avatar-action-btn.delete:hover {
    background: rgba(255,68,68,0.1);
}

body.light-theme .drawing-action-btn {
    background: rgba(0, 0, 0, 0.03);
    color: #555;
}

body.light-theme .drawing-action-btn.save {
    background: linear-gradient(135deg, #667eea, #764ba2);
    color: white;
}

body.light-theme .drawing-action-btn.clear {
    background: rgba(255,68,68,0.1);
    color: #ff4757;
    border: 1px solid rgba(255,68,68,0.3);
}

body.light-theme .drawing-action-btn.cancel {
    background: rgba(0, 0, 0, 0.03);
    border: 1px solid rgba(0, 0, 0, 0.1);
    color: #555;
}

body.light-theme .comment-submit {
    background: linear-gradient(135deg, #667eea, #764ba2);
    color: white;
}

body.light-theme .post-btn {
    background: linear-gradient(135deg, #667eea, #764ba2);
    color: white;
}

body.light-theme .stat-value {
    color: #667eea;
}

body.light-theme .user-item-name,
body.light-theme .profile-modal-name {
    color: #333;
}

body.light-theme ::placeholder {
    color: #999;
}

/* –ù–∞–≤–∏–≥–∞—Ü–∏—è */
.navbar {
    background: rgba(0, 0, 0, 0.8);
    backdrop-filter: blur(20px);
    -webkit-backdrop-filter: blur(20px);
    padding: 1rem;
    position: sticky;
    top: 0;
    z-index: 100;
    border-bottom: 1px solid rgba(255, 255, 255, 0.1);
    transition: all 0.3s ease;
}

.nav-content {
    max-width: 600px;
    margin: 0 auto;
    display: flex;
    justify-content: space-between;
    align-items: center;
}

.logo {
    font-size: 1.8rem;
    font-weight: 800;
    background: linear-gradient(135deg, #667eea, #764ba2, #667eea);
    background-size: 300% 300%;
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    animation: gradientFlow 8s ease infinite;
    letter-spacing: 2px;
}

@keyframes gradientFlow {
    0%, 100% { background-position: 0% 50%; }
    50% { background-position: 100% 50%; }
}

.nav-icons {
    display: flex;
    align-items: center;
    gap: 1.2rem;
}

.nav-icon {
    font-size: 1.5rem;
    cursor: pointer;
    transition: transform 0.2s;
    color: white;
}

.nav-icon:hover {
    transform: scale(1.1);
}

.user-info {
    display: flex;
    align-items: center;
    gap: 0.8rem;
}

.user-name {
    font-weight: 500;
    font-size: 0.95rem;
    color: white;
    max-width: 120px;
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
}

.logout-btn {
    background: rgba(255, 68, 68, 0.15);
    border: 1px solid rgba(255, 68, 68, 0.3);
    color: #ff6b6b;
    padding: 0.4rem 1rem;
    border-radius: 50px;
    cursor: pointer;
    font-size: 0.8rem;
    transition: all 0.2s;
}

.logout-btn:hover {
    background: #ff4757;
    color: white;
    transform: translateY(-2px);
    box-shadow: 0 5px 15px rgba(255, 71, 87, 0.4);
}

/* –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä */
.container {
    max-width: 600px;
    margin: 0 auto;
    padding: 1rem;
    padding-bottom: 90px;
    animation: fadeSlideUp 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

@keyframes fadeSlideUp {
    0% { opacity: 0; transform: translateY(30px); }
    100% { opacity: 1; transform: translateY(0); }
}

/* –ü—Ä–æ—Ñ–∏–ª—å */
.profile-section {
    background: rgba(17, 17, 17, 0.8);
    backdrop-filter: blur(10px);
    -webkit-backdrop-filter: blur(10px);
    border-radius: 30px;
    padding: 1.5rem;
    margin-bottom: 1.5rem;
    border: 1px solid rgba(255, 255, 255, 0.1);
    transition: all 0.3s;
}

.profile-section:hover {
    transform: translateY(-5px);
    box-shadow: 0 20px 40px rgba(102, 126, 234, 0.3);
}

.profile-header {
    display: flex;
    gap: 1.5rem;
    align-items: center;
}

.profile-avatar {
    width: 90px;
    height: 90px;
    background: linear-gradient(135deg, #667eea, #764ba2);
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 2.5rem;
    box-shadow: 0 10px 30px rgba(102, 126, 234, 0.5);
    cursor: pointer;
    position: relative;
    overflow: hidden;
    background-size: cover;
    background-position: center;
    animation: pulse 4s ease infinite;
}

@keyframes pulse {
    0%, 100% { box-shadow: 0 10px 30px rgba(102, 126, 234, 0.5); }
    50% { box-shadow: 0 20px 50px rgba(102, 126, 234, 0.8); }
}

.profile-avatar.drawn-avatar {
    background: none;
    animation: none;
}

.profile-avatar .avatar-overlay {
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: rgba(0,0,0,0.5);
    display: flex;
    align-items: center;
    justify-content: center;
    opacity: 0;
    transition: opacity 0.2s;
    border-radius: 50%;
    color: white;
    font-size: 1.5rem;
    backdrop-filter: blur(5px);
}

.profile-avatar:hover .avatar-overlay {
    opacity: 1;
}

.avatar-actions {
    display: flex;
    gap: 0.5rem;
    margin-top: 0.5rem;
    justify-content: center;
}

.avatar-action-btn {
    background: rgba(255,255,255,0.05);
    border: 1px solid rgba(255,255,255,0.1);
    color: white;
    padding: 0.3rem 1rem;
    border-radius: 30px;
    cursor: pointer;
    font-size: 0.8rem;
    transition: all 0.2s;
}

.avatar-action-btn:hover {
    background: rgba(102, 126, 234, 0.3);
    transform: translateY(-2px);
}

.avatar-action-btn.delete {
    color: #ff6b6b;
    border-color: rgba(255,68,68,0.3);
}

.avatar-action-btn.delete:hover {
    background: rgba(255,68,68,0.2);
}

.profile-info {
    flex: 1;
}

.profile-name {
    font-size: 1.5rem;
    font-weight: 700;
    margin-bottom: 0.3rem;
    background: linear-gradient(135deg, #fff, #e0e0e0);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
}

.profile-username {
    color: #888;
    font-size: 0.9rem;
    margin-bottom: 0.5rem;
    cursor: pointer;
    transition: color 0.2s;
}

.profile-username:hover {
    color: #667eea;
}

.verified-badge {
    color: #667eea;
    font-size: 1rem;
    animation: sparkle 3s ease infinite;
}

@keyframes sparkle {
    0%, 100% { opacity: 1; transform: scale(1); }
    50% { opacity: 0.8; transform: scale(1.2); }
}

.profile-bio {
    color: #b0b0b0;
    font-size: 0.95rem;
    margin-bottom: 1rem;
}

.profile-stats {
    display: flex;
    gap: 2rem;
    justify-content: space-between;
    align-items: center;
}

.stat {
    text-align: center;
    cursor: pointer;
    transition: transform 0.2s;
    flex: 1;
    display: flex;
    flex-direction: column;
    align-items: center;
}

.stat:first-child {
    text-align: left;
    align-items: flex-start;
}

.stat:last-child {
    text-align: right;
    align-items: flex-end;
}

.stat:hover {
    transform: translateY(-3px);
}

.stat-value {
    font-weight: 700;
    font-size: 1.2rem;
    color: #667eea;
}

.stat-label {
    color: #888;
    font-size: 0.75rem;
    text-transform: uppercase;
    letter-spacing: 1px;
}

.edit-profile-btn {
    width: 100%;
    padding: 0.9rem;
    background: rgba(102, 126, 234, 0.15);
    border: 1px solid rgba(102, 126, 234, 0.3);
    border-radius: 50px;
    color: white;
    cursor: pointer;
    margin-top: 1.2rem;
    font-weight: 600;
    font-size: 1rem;
    transition: all 0.2s;
    position: relative;
    overflow: hidden;
    z-index: 1;
}

.edit-profile-btn::before {
    content: '';
    position: absolute;
    top: 50%;
    left: 50%;
    width: 0;
    height: 0;
    border-radius: 50%;
    background: rgba(255, 255, 255, 0.2);
    transform: translate(-50%, -50%);
    transition: width 0.6s, height 0.6s;
    z-index: -1;
}

.edit-profile-btn:hover {
    transform: translateY(-2px);
    box-shadow: 0 10px 25px rgba(102, 126, 234, 0.4);
}

.edit-profile-btn:hover::before {
    width: 300px;
    height: 300px;
}

/* –§–æ—Ä–º–∞ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è */
.edit-profile-form {
    background: rgba(17, 17, 17, 0.95);
    backdrop-filter: blur(10px);
    border-radius: 30px;
    padding: 1.5rem;
    margin-bottom: 1.5rem;
    border: 1px solid rgba(255, 255, 255, 0.1);
    display: none;
    animation: slideDown 0.4s cubic-bezier(0.4, 0, 0.2, 1);
}

@keyframes slideDown {
    from { opacity: 0; transform: translateY(-30px); }
    to { opacity: 1; transform: translateY(0); }
}

.edit-profile-form h3 {
    margin-bottom: 1rem;
    color: #667eea;
    font-size: 1.2rem;
}

.edit-profile-form input,
.edit-profile-form textarea {
    width: 100%;
    padding: 0.9rem;
    margin-bottom: 1rem;
    background: rgba(255,255,255,0.05);
    border: 1px solid rgba(255,255,255,0.1);
    border-radius: 16px;
    color: white;
    font-size: 0.95rem;
    transition: all 0.2s;
}

.edit-profile-form input:focus,
.edit-profile-form textarea:focus {
    outline: none;
    border-color: #667eea;
    background: rgba(102, 126, 234, 0.1);
    transform: scale(1.02);
}

.form-actions {
    display: flex;
    gap: 0.5rem;
}

.save-btn, .cancel-btn {
    flex: 1;
    padding: 0.9rem;
    border-radius: 50px;
    cursor: pointer;
    font-weight: 600;
    transition: all 0.2s;
}

.save-btn {
    background: linear-gradient(135deg, #667eea, #764ba2);
    color: white;
    border: none;
}

.save-btn:hover {
    transform: translateY(-2px);
    box-shadow: 0 10px 20px rgba(102, 126, 234, 0.4);
}

.cancel-btn {
    background: rgba(255,255,255,0.05);
    border: 1px solid rgba(255,255,255,0.1);
    color: white;
}

.cancel-btn:hover {
    background: rgba(255,255,255,0.1);
    transform: translateY(-2px);
}

/* –°–æ–∑–¥–∞–Ω–∏–µ –ø–æ—Å—Ç–∞ */
.create-post {
    background: rgba(17, 17, 17, 0.8);
    backdrop-filter: blur(10px);
    border-radius: 30px;
    padding: 1.2rem;
    margin-bottom: 1.5rem;
    border: 1px solid rgba(255, 255, 255, 0.1);
    transition: all 0.3s;
}

.create-post:focus-within {
    transform: scale(1.02);
    box-shadow: 0 10px 30px rgba(102, 126, 234, 0.3);
}

.create-post textarea {
    width: 100%;
    padding: 1rem;
    background: rgba(255,255,255,0.05);
    border: 1px solid rgba(255,255,255,0.1);
    border-radius: 20px;
    color: white;
    min-height: 100px;
    margin-bottom: 1rem;
    resize: vertical;
    transition: all 0.2s;
    font-size: 1rem;
}

.create-post textarea:focus {
    outline: none;
    border-color: #667eea;
    background: rgba(102, 126, 234, 0.1);
}

.post-tools {
    display: flex;
    gap: 0.5rem;
    margin-bottom: 1rem;
    flex-wrap: wrap;
}

.tool-btn {
    background: rgba(255,255,255,0.05);
    border: 1px solid rgba(255,255,255,0.1);
    color: white;
    padding: 0.6rem 1.2rem;
    border-radius: 50px;
    cursor: pointer;
    font-size: 0.9rem;
    transition: all 0.2s;
    display: flex;
    align-items: center;
    gap: 0.3rem;
}

.tool-btn:hover {
    background: rgba(102, 126, 234, 0.3);
    transform: translateY(-2px);
}

/* –†–∏—Å–æ–≤–∞–Ω–∏–µ */
.drawing-container {
    background: rgba(0,0,0,0.2);
    border-radius: 20px;
    padding: 1rem;
    margin-bottom: 1rem;
    animation: fadeIn 0.3s;
}

@keyframes fadeIn {
    from { opacity: 0; }
    to { opacity: 1; }
}

.drawing-canvas-wrapper {
    width: 100%;
    aspect-ratio: 1 / 1;
    background: white;
    border-radius: 20px;
    overflow: hidden;
    margin-bottom: 1rem;
    box-shadow: 0 4px 15px rgba(0,0,0,0.2);
}

.drawing-canvas {
    width: 100%;
    height: 100%;
    display: block;
    background: white;
    cursor: crosshair;
    touch-action: none;
}

.drawing-tools {
    display: flex;
    flex-direction: column;
    gap: 1rem;
}

.color-palette {
    display: flex;
    gap: 0.5rem;
    flex-wrap: wrap;
    justify-content: center;
}

.color-btn {
    width: 40px;
    height: 40px;
    border-radius: 50%;
    border: 2px solid rgba(255,255,255,0.2);
    cursor: pointer;
    transition: all 0.2s;
}

.color-btn:hover {
    transform: scale(1.1);
    border-color: #667eea;
}

.color-btn.active {
    border-color: #667eea;
    transform: scale(1.1);
}

.brush-size-control {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 0.5rem;
}

.brush-size-buttons {
    display: flex;
    gap: 0.5rem;
    justify-content: center;
    flex-wrap: wrap;
}

.brush-size-btn {
    background: rgba(255,255,255,0.05);
    border: 1px solid rgba(255,255,255,0.1);
    color: white;
    padding: 0.4rem 1rem;
    border-radius: 30px;
    cursor: pointer;
    font-size: 0.9rem;
    transition: all 0.2s;
}

.brush-size-btn:hover {
    background: rgba(102, 126, 234, 0.3);
    transform: translateY(-2px);
}

.brush-size-btn.active {
    background: #667eea;
    color: white;
}

.brush-preview {
    width: 30px;
    height: 30px;
    border-radius: 50%;
    background: white;
    display: inline-block;
}

.drawing-actions {
    display: flex;
    gap: 0.5rem;
    justify-content: center;
    margin-top: 0.5rem;
}

.drawing-action-btn {
    padding: 0.5rem 1.5rem;
    border-radius: 30px;
    cursor: pointer;
    font-weight: 500;
    transition: all 0.2s;
    border: none;
}

.drawing-action-btn.clear {
    background: rgba(255,68,68,0.2);
    color: #ff6b6b;
    border: 1px solid rgba(255,68,68,0.3);
}

.drawing-action-btn.clear:hover {
    background: rgba(255,68,68,0.3);
    transform: translateY(-2px);
}

.drawing-action-btn.save {
    background: linear-gradient(135deg, #667eea, #764ba2);
    color: white;
}

.drawing-action-btn.save:hover {
    transform: translateY(-2px);
    box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
}

.drawing-action-btn.cancel {
    background: rgba(255,255,255,0.05);
    color: white;
    border: 1px solid rgba(255,255,255,0.1);
}

.drawing-action-btn.cancel:hover {
    background: rgba(255,255,255,0.1);
    transform: translateY(-2px);
}

.post-btn {
    width: 100%;
    padding: 1rem;
    background: linear-gradient(135deg, #667eea, #764ba2);
    border: none;
    border-radius: 50px;
    color: white;
    cursor: pointer;
    font-weight: 600;
    font-size: 1rem;
    transition: all 0.2s;
    position: relative;
    overflow: hidden;
}

.post-btn::before {
    content: '';
    position: absolute;
    top: 50%;
    left: 50%;
    width: 0;
    height: 0;
    border-radius: 50%;
    background: rgba(255,255,255,0.3);
    transform: translate(-50%, -50%);
    transition: width 0.6s, height 0.6s;
}

.post-btn:hover {
    transform: translateY(-2px);
    box-shadow: 0 10px 25px rgba(102, 126, 234, 0.5);
}

.post-btn:hover::before {
    width: 300px;
    height: 300px;
}

/* –ü–æ—Å—Ç—ã */
.post {
    background: rgba(17, 17, 17, 0.8);
    backdrop-filter: blur(10px);
    border-radius: 30px;
    padding: 1.2rem;
    margin-bottom: 1.2rem;
    border: 1px solid rgba(255, 255, 255, 0.1);
    transition: all 0.2s;
    animation: slideUp 0.5s ease;
}

@keyframes slideUp {
    from { opacity: 0; transform: translateY(30px); }
    to { opacity: 1; transform: translateY(0); }
}

.post:hover {
    transform: translateY(-2px);
    box-shadow: 0 15px 30px rgba(102, 126, 234, 0.2);
    border-color: rgba(102, 126, 234, 0.3);
}

.post-header {
    display: flex;
    align-items: center;
    margin-bottom: 1rem;
    cursor: pointer;
}

.post-avatar {
    width: 48px;
    height: 48px;
    background: linear-gradient(135deg, #667eea, #764ba2);
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    margin-right: 1rem;
    font-weight: bold;
    background-size: cover;
    background-position: center;
    transition: transform 0.2s;
}

.post-avatar.drawn-avatar {
    background: none;
}

.post-avatar:hover {
    transform: scale(1.05);
}

.post-author-info {
    flex: 1;
}

.post-author {
    font-weight: 600;
    font-size: 1rem;
    color: white;
    display: flex;
    align-items: center;
    gap: 0.3rem;
}

.post-username {
    color: #888;
    font-size: 0.75rem;
}

.post-time {
    color: #888;
    font-size: 0.7rem;
    padding: 0.3rem 0.8rem;
    background: rgba(255,255,255,0.05);
    border-radius: 50px;
    display: inline-block;
}

.post-content {
    color: #e0e0e0;
    font-size: 1rem;
    line-height: 1.6;
    margin-bottom: 1rem;
    white-space: pre-wrap;
    word-break: break-word;
}

.hashtag {
    color: #667eea;
    cursor: pointer;
    font-weight: 500;
    transition: color 0.2s;
}

.hashtag:hover {
    color: #764ba2;
    text-decoration: underline;
}

.mention {
    color: #764ba2;
    cursor: pointer;
    transition: color 0.2s;
}

.mention:hover {
    color: #667eea;
    text-decoration: underline;
}

.post-drawing {
    width: 100%;
    aspect-ratio: 1 / 1;
    object-fit: cover;
    border-radius: 20px;
    margin-bottom: 1rem;
    background: white;
    image-rendering: pixelated;
}

.delete-btn {
    color: #ff6b6b;
    cursor: pointer;
    font-size: 1.2rem;
    transition: transform 0.2s;
    margin-left: 0.5rem;
}

.delete-btn:hover {
    transform: scale(1.2);
}

/* –õ–∞–π–∫–∏ */
.post-like-btn {
    background: rgba(255,255,255,0.05);
    border: 1px solid rgba(255,255,255,0.1);
    border-radius: 50px;
    padding: 0.5rem 1.2rem;
    cursor: pointer;
    font-size: 0.9rem;
    display: flex;
    align-items: center;
    gap: 0.5rem;
    transition: all 0.2s;
    color: #888;
}

.post-like-btn:hover {
    background: rgba(102, 126, 234, 0.2);
    border-color: #667eea;
    transform: translateY(-2px);
}

.post-like-btn.liked {
    background: linear-gradient(135deg, #667eea, #764ba2);
    color: white;
    animation: heartBeat 0.4s cubic-bezier(0.4, 0, 0.2, 1);
}

@keyframes heartBeat {
    0%, 100% { transform: scale(1); }
    50% { transform: scale(1.2); }
}

.post-actions {
    display: flex;
    align-items: center;
    gap: 1rem;
    margin-top: 0.5rem;
    padding-top: 0.5rem;
    border-top: 1px solid rgba(255,255,255,0.1);
    flex-wrap: wrap;
}

.comment-toggle {
    color: #888;
    cursor: pointer;
    padding: 0.3rem 0;
    display: inline-block;
    transition: all 0.2s;
    font-size: 0.95rem;
}

.comment-toggle:hover {
    color: #667eea;
    transform: translateX(5px);
}

.follow-btn {
    background: transparent;
    border: 1px solid #667eea;
    color: #667eea;
    padding: 0.4rem 1.2rem;
    border-radius: 50px;
    cursor: pointer;
    font-size: 0.85rem;
    margin-left: auto;
    transition: all 0.2s;
}

.follow-btn:hover {
    background: #667eea;
    color: white;
    transform: translateY(-2px);
    box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
}

.follow-btn.following {
    background: rgba(102, 126, 234, 0.2);
    color: #888;
}

/* –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ */
.comments-section {
    margin-top: 1rem;
    padding-top: 1rem;
    border-top: 1px solid rgba(255,255,255,0.1);
    display: none;
    animation: fadeIn 0.3s;
}

.comment {
    display: flex;
    gap: 0.5rem;
    margin-bottom: 1rem;
    animation: slideRight 0.2s;
}

@keyframes slideRight {
    from { opacity: 0; transform: translateX(-10px); }
    to { opacity: 1; transform: translateX(0); }
}

.comment-avatar {
    width: 36px;
    height: 36px;
    background: linear-gradient(135deg, #667eea, #764ba2);
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 0.9rem;
    flex-shrink: 0;
    background-size: cover;
    background-position: center;
    cursor: pointer;
}

.comment-avatar.drawn-avatar {
    background: none;
}

.comment-content {
    flex: 1;
    background: rgba(255,255,255,0.05);
    padding: 0.6rem 1rem;
    border-radius: 20px;
    transition: all 0.2s;
}

.comment-content:hover {
    background: rgba(255,255,255,0.1);
}

.comment-header {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    margin-bottom: 0.2rem;
}

.comment-author {
    font-weight: 600;
    font-size: 0.85rem;
    color: white;
    cursor: pointer;
    transition: color 0.2s;
}

.comment-author:hover {
    color: #667eea;
}

.comment-text {
    font-size: 0.9rem;
    color: #e0e0e0;
}

.comment-footer {
    display: flex;
    align-items: center;
    gap: 1rem;
    margin-top: 0.3rem;
}

.comment-like-btn {
    background: transparent;
    border: 1px solid rgba(255,255,255,0.1);
    border-radius: 20px;
    padding: 0.2rem 0.8rem;
    font-size: 0.75rem;
    cursor: pointer;
    display: flex;
    align-items: center;
    gap: 0.2rem;
    color: #888;
    transition: all 0.2s;
}

.comment-like-btn:hover {
    background: rgba(102, 126, 234, 0.2);
    border-color: #667eea;
    transform: translateY(-2px);
}

.comment-like-btn.liked {
    background: linear-gradient(135deg, #667eea, #764ba2);
    color: white;
}

.comment-delete-btn {
    color: #ff6b6b;
    font-size: 1rem;
    cursor: pointer;
    transition: transform 0.2s;
    margin-left: 0.3rem;
}

.comment-delete-btn:hover {
    transform: scale(1.2);
}

.add-comment {
    display: flex;
    gap: 0.5rem;
    margin-top: 0.5rem;
}

.add-comment input {
    flex: 1;
    padding: 0.7rem 1rem;
    background: rgba(255,255,255,0.05);
    border: 1px solid rgba(255,255,255,0.1);
    border-radius: 30px;
    color: white;
    transition: all 0.2s;
    font-size: 0.95rem;
}

.add-comment input:focus {
    outline: none;
    border-color: #667eea;
    background: rgba(102, 126, 234, 0.1);
    transform: scale(1.02);
}

.comment-submit {
    background: linear-gradient(135deg, #667eea, #764ba2);
    color: white;
    border: none;
    width: 44px;
    height: 44px;
    border-radius: 50%;
    cursor: pointer;
    font-size: 1.2rem;
    transition: all 0.2s;
}

.comment-submit:hover {
    transform: scale(1.1) rotate(360deg);
}

/* –ö–Ω–æ–ø–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è */
.refresh-container {
    display: flex;
    justify-content: center;
    margin-bottom: 1.5rem;
}

.refresh-btn {
    background: rgba(102, 126, 234, 0.15);
    border: 1px solid rgba(102, 126, 234, 0.3);
    color: #667eea;
    padding: 0.7rem 2rem;
    border-radius: 50px;
    cursor: pointer;
    font-size: 0.95rem;
    font-weight: 500;
    transition: all 0.2s;
    backdrop-filter: blur(5px);
    position: relative;
    overflow: hidden;
}

.refresh-btn::before {
    content: '';
    position: absolute;
    top: 50%;
    left: 50%;
    width: 0;
    height: 0;
    border-radius: 50%;
    background: rgba(255, 255, 255, 0.2);
    transform: translate(-50%, -50%);
    transition: width 0.6s, height 0.6s;
}

.refresh-btn:hover {
    background: rgba(102, 126, 234, 0.25);
    transform: translateY(-2px);
    box-shadow: 0 5px 15px rgba(102, 126, 234, 0.3);
}

.refresh-btn:hover::before {
    width: 300px;
    height: 300px;
}

.refresh-btn:active {
    transform: translateY(0);
}

/* –ù–∏–∂–Ω—è—è –Ω–∞–≤–∏–≥–∞—Ü–∏—è */
.bottom-nav {
    position: fixed;
    bottom: 0;
    left: 0;
    right: 0;
    background: rgba(0, 0, 0, 0.9);
    backdrop-filter: blur(20px);
    display: flex;
    justify-content: space-around;
    padding: 0.5rem 0.2rem;
    border-top: 1px solid rgba(255, 255, 255, 0.1);
    z-index: 99;
    animation: slideUp 0.4s cubic-bezier(0.4, 0, 0.2, 1);
}

@keyframes slideUp {
    from { transform: translateY(100%); }
    to { transform: translateY(0); }
}

.nav-item {
    display: flex;
    flex-direction: column;
    align-items: center;
    color: #888;
    font-size: 0.65rem;
    cursor: pointer;
    padding: 0.3rem 0.3rem;
    border-radius: 12px;
    transition: all 0.2s;
    flex: 1;
    max-width: 70px;
}

.nav-item span:first-child {
    font-size: 1.3rem;
    margin-bottom: 0.1rem;
    transition: transform 0.2s;
}

.nav-item:hover {
    color: #667eea;
}

.nav-item:hover span:first-child {
    transform: translateY(-3px);
}

.nav-item.active {
    color: #667eea;
    background: rgba(102, 126, 234, 0.15);
}

.nav-item.active span:first-child {
    animation: bounce 0.3s;
}

@keyframes bounce {
    0%, 100% { transform: scale(1); }
    50% { transform: scale(1.1); }
}

/* –ú–æ–¥–∞–ª—å–Ω—ã–µ –æ–∫–Ω–∞ */
.modal {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: rgba(0,0,0,0.95);
    backdrop-filter: blur(20px);
    z-index: 1000;
    display: none;
    align-items: center;
    justify-content: center;
    padding: 1rem;
    animation: modalFade 0.3s;
}

@keyframes modalFade {
    from { opacity: 0; }
    to { opacity: 1; }
}

.modal-content {
    background: #111;
    border-radius: 30px;
    padding: 1.5rem;
    max-width: 500px;
    width: 100%;
    border: 1px solid rgba(255,255,255,0.1);
    max-height: 90vh;
    overflow-y: auto;
    animation: modalSlide 0.3s;
}

@keyframes modalSlide {
    from { opacity: 0; transform: translateY(-30px); }
    to { opacity: 1; transform: translateY(0); }
}

.modal h3 {
    margin-bottom: 1rem;
    color: #667eea;
    font-size: 1.2rem;
}

/* –†–∏—Å–æ–≤–∞–Ω–∏–µ –∞–≤–∞—Ç–∞—Ä–∞ */
.avatar-drawing-content {
    max-width: 450px;
}

.avatar-drawing-canvas-wrapper {
    width: 200px;
    height: 200px;
    margin: 0 auto 1rem;
    border-radius: 50%;
    overflow: hidden;
    border: 3px solid #667eea;
    box-shadow: 0 4px 15px rgba(0,0,0,0.2);
}

.avatar-drawing-canvas {
    width: 100%;
    height: 100%;
    display: block;
    background: white;
    cursor: crosshair;
    touch-action: none;
}

.avatar-preview-text {
    text-align: center;
    color: #888;
    margin-bottom: 1rem;
    font-size: 0.85rem;
}

/* –•–µ—à—Ç–µ–≥–∏ */
.hashtag-modal .modal-content {
    max-width: 400px;
}

.hashtag-info {
    background: rgba(255,255,255,0.05);
    border-radius: 20px;
    padding: 1.5rem;
    margin-bottom: 1rem;
    text-align: center;
}

.hashtag-name {
    font-size: 1.5rem;
    color: #667eea;
    margin-bottom: 0.5rem;
    font-weight: 600;
}

.hashtag-count {
    font-size: 2rem;
    font-weight: 700;
    margin-bottom: 0.3rem;
}

.hashtag-label {
    color: #888;
    font-size: 0.85rem;
}

.hashtag-posts {
    max-height: 300px;
    overflow-y: auto;
    margin-bottom: 1rem;
}

.hashtag-post-item {
    background: rgba(255,255,255,0.02);
    border: 1px solid rgba(255,255,255,0.05);
    border-radius: 20px;
    padding: 1rem;
    margin-bottom: 0.5rem;
    cursor: pointer;
    transition: all 0.2s;
}

.hashtag-post-item:hover {
    background: rgba(102, 126, 234, 0.1);
    border-color: #667eea;
    transform: translateX(5px);
}

.hashtag-post-author {
    font-weight: 600;
    margin-bottom: 0.3rem;
}

.hashtag-post-content {
    color: #888;
    font-size: 0.9rem;
}

/* –ü—Ä–æ—Ñ–∏–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è */
.profile-modal-content {
    max-width: 500px;
}

.profile-modal-header {
    display: flex;
    align-items: center;
    gap: 1rem;
    margin-bottom: 1rem;
}

.profile-modal-avatar {
    width: 70px;
    height: 70px;
    border-radius: 50%;
    background: linear-gradient(135deg, #667eea, #764ba2);
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 2rem;
    background-size: cover;
    background-position: center;
}

.profile-modal-info {
    flex: 1;
}

.profile-modal-name {
    font-size: 1.2rem;
    font-weight: 600;
    margin-bottom: 0.2rem;
    color: white;
}

.profile-modal-username {
    color: #888;
    font-size: 0.9rem;
}

.profile-modal-bio {
    color: #b0b0b0;
    margin-bottom: 1rem;
    font-size: 0.95rem;
}

.profile-modal-stats {
    display: flex;
    gap: 2rem;
    margin-bottom: 1.5rem;
    justify-content: center;
}

.profile-posts-section {
    margin-top: 1.5rem;
}

.profile-posts-section h4 {
    margin-bottom: 1rem;
    color: #667eea;
}

.profile-posts-list {
    max-height: 300px;
    overflow-y: auto;
}

.profile-post-item {
    background: rgba(255,255,255,0.02);
    border: 1px solid rgba(255,255,255,0.05);
    border-radius: 20px;
    padding: 1rem;
    margin-bottom: 0.5rem;
    cursor: pointer;
    transition: all 0.2s;
}

.profile-post-item:hover {
    background: rgba(102, 126, 234, 0.1);
    border-color: #667eea;
    transform: translateX(5px);
}

.profile-post-content {
    color: #e0e0e0;
    margin-bottom: 0.3rem;
}

.profile-post-stats {
    display: flex;
    gap: 1rem;
    color: #888;
    font-size: 0.8rem;
}

/* –°–ø–∏—Å–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π */
.users-list {
    max-height: 400px;
    overflow-y: auto;
}

.user-item {
    display: flex;
    align-items: center;
    gap: 1rem;
    padding: 0.8rem;
    background: rgba(255,255,255,0.02);
    border: 1px solid rgba(255,255,255,0.05);
    border-radius: 20px;
    margin-bottom: 0.5rem;
    cursor: pointer;
    transition: all 0.2s;
}

.user-item:hover {
    background: rgba(102, 126, 234, 0.1);
    border-color: #667eea;
    transform: translateX(5px);
}

.user-item-avatar {
    width: 44px;
    height: 44px;
    border-radius: 50%;
    background: linear-gradient(135deg, #667eea, #764ba2);
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 1.2rem;
    background-size: cover;
    background-position: center;
}

.user-item-info {
    flex: 1;
}

.user-item-name {
    font-weight: 600;
    margin-bottom: 0.2rem;
    color: white;
}

.user-item-username {
    color: #888;
    font-size: 0.8rem;
}

/* –ü—É—Å—Ç–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ */
.empty-state {
    text-align: center;
    padding: 2rem;
    color: #888;
    background: rgba(255,255,255,0.02);
    border-radius: 20px;
    border: 1px dashed rgba(255,255,255,0.1);
}

/* –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è */
.notification-toast {
    position: fixed;
    bottom: 80px;
    left: 50%;
    transform: translateX(-50%) translateY(100px);
    background: linear-gradient(135deg, #667eea, #764ba2);
    color: white;
    padding: 0.8rem 1.5rem;
    border-radius: 50px;
    box-shadow: 0 10px 30px rgba(102, 126, 234, 0.5);
    z-index: 1000;
    transition: transform 0.3s ease;
    animation: slideUpToast 0.3s forwards;
}

@keyframes slideUpToast {
    to { transform: translateX(-50%) translateY(0); }
}

/* –ê–¥–∞–ø—Ç–∞—Ü–∏—è */
@media (max-width: 480px) {
    .profile-header {
        flex-direction: column;
        text-align: center;
    }
    
    .profile-info {
        align-items: center;
    }
    
    .profile-stats {
        justify-content: center;
    }
    
    .post-time {
        font-size: 0.65rem;
    }

    .nav-item {
        font-size: 0.6rem;
    }
    
    .nav-item span:first-child {
        font-size: 1.2rem;
    }

    .color-btn {
        width: 35px;
        height: 35px;
    }
}

/* –°–∫—Ä–æ–ª–ª–±–∞—Ä */
::-webkit-scrollbar {
    width: 8px;
}

::-webkit-scrollbar-track {
    background: rgba(0,0,0,0.1);
}

::-webkit-scrollbar-thumb {
    background: linear-gradient(135deg, #667eea, #764ba2);
    border-radius: 10px;
}

::-webkit-scrollbar-thumb:hover {
    background: linear-gradient(135deg, #764ba2, #667eea);
}
    </style>
</head>
<body>
<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Void ‚ú¶ –°–æ—Ü–∏–∞–ª—å–Ω–∞—è —Å–µ—Ç—å</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <!-- –ù–∞–≤–∏–≥–∞—Ü–∏—è -->
    <nav class="navbar">
        <div class="nav-content">
            <div class="logo">VOID</div>
            <div class="nav-icons">
                <div class="nav-icon" id="themeIcon">üåô</div>
                <div class="user-info" id="userInfo">
                    <span class="user-name" id="currentUserName"></span>
                    <button class="logout-btn" id="logoutBtn">–í—ã–π—Ç–∏</button>
                </div>
            </div>
        </div>
    </nav>

    <!-- –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–Ω—Ç -->
    <div class="container" id="mainContent">
        <!-- –ü—Ä–æ—Ñ–∏–ª—å -->
        <div class="profile-section" id="profileSection" style="display: none;">
            <div class="profile-header">
                <div class="profile-avatar" id="profileAvatar" onclick="openAvatarDrawing()">
                    <div class="avatar-overlay">‚úèÔ∏è</div>
                </div>
                <div class="profile-info">
                    <div class="profile-name" id="profileName"></div>
                    <div class="profile-username" id="profileUsername"></div>
                    <div class="profile-bio" id="profileBio"></div>
                    <div class="profile-stats">
                        <div class="stat" onclick="showFollowers()">
                            <div class="stat-value" id="followersCount">0</div>
                            <div class="stat-label">–ø–æ–¥–ø–∏—Å—á–∏–∫–∏</div>
                        </div>
                        <div class="stat" onclick="showFollowing()">
                            <div class="stat-value" id="followingCount">0</div>
                            <div class="stat-label">–ø–æ–¥–ø–∏—Å–∫–∏</div>
                        </div>
                        <div class="stat">
                            <div class="stat-value" id="totalLikesCount">0</div>
                            <div class="stat-label">–ª–∞–π–∫–∏</div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="avatar-actions" id="avatarActions" style="display: none;">
                <button class="avatar-action-btn" id="newAvatarBtn">–ù–æ–≤–∞—è</button>
                <button class="avatar-action-btn delete" id="deleteAvatarBtn">–£–¥–∞–ª–∏—Ç—å</button>
            </div>
            <button class="edit-profile-btn" id="editProfileBtn">–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ—Ñ–∏–ª—å</button>
        </div>

        <!-- –§–æ—Ä–º–∞ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è -->
        <div class="edit-profile-form" id="editProfileForm" style="display: none;">
            <h3>–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ—Ñ–∏–ª—å</h3>
            <input type="text" id="editName" placeholder="–ò–º—è">
            <input type="text" id="editUsername" placeholder="–Æ–∑–µ—Ä–Ω–µ–π–º (–ª–∞—Ç–∏–Ω–∏—Ü–∞, —Ü–∏—Ñ—Ä—ã, _, 5-50 —Å–∏–º–≤–æ–ª–æ–≤)">
            <textarea id="editBio" placeholder="–û —Å–µ–±–µ" maxlength="150"></textarea>
            <div class="form-actions">
                <button class="save-btn" id="saveProfileBtn">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
                <button class="cancel-btn" id="cancelEditBtn">–û—Ç–º–µ–Ω–∞</button>
            </div>
        </div>

        <!-- –°–æ–∑–¥–∞–Ω–∏–µ –ø–æ—Å—Ç–∞ -->
        <div class="create-post" id="createPostSection" style="display: none;">
            <textarea id="postContent" placeholder="–ß—Ç–æ —É –≤–∞—Å –Ω–æ–≤–æ–≥–æ?"></textarea>
            <div class="post-tools">
                <button class="tool-btn" id="hashtagBtn"># –•–µ—à—Ç–µ–≥</button>
                <button class="tool-btn" id="drawingBtn">‚úèÔ∏è –†–∏—Å—É–Ω–æ–∫</button>
            </div>
            
            <!-- –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è —Ä–∏—Å–æ–≤–∞–Ω–∏—è -->
            <div class="drawing-container" id="drawingContainer" style="display: none;">
                <div class="drawing-canvas-wrapper">
                    <canvas id="postDrawingCanvas" class="drawing-canvas" width="400" height="400"></canvas>
                </div>
                
                <div class="drawing-tools">
                    <div class="color-palette">
                        <button class="color-btn" style="background: #000000;" data-color="#000000"></button>
                        <button class="color-btn" style="background: #ff4444;" data-color="#ff4444"></button>
                        <button class="color-btn" style="background: #ff8800;" data-color="#ff8800"></button>
                        <button class="color-btn" style="background: #ffdd44;" data-color="#ffdd44"></button>
                        <button class="color-btn" style="background: #44ff44;" data-color="#44ff44"></button>
                        <button class="color-btn" style="background: #44ddff;" data-color="#44ddff"></button>
                        <button class="color-btn" style="background: #667eea;" data-color="#667eea"></button>
                        <button class="color-btn" style="background: #aa44ff;" data-color="#aa44ff"></button>
                        <button class="color-btn" style="background: #ff44aa;" data-color="#ff44aa"></button>
                        <button class="color-btn" style="background: #ffffff;" data-color="#ffffff"></button>
                    </div>
                    
                    <div class="brush-size-control">
                        <span style="color: #888;">–¢–æ–ª—â–∏–Ω–∞:</span>
                        <div class="brush-size-buttons">
                            <button class="brush-size-btn" data-size="2">–ú–µ–ª–∫–∏–π</button>
                            <button class="brush-size-btn active" data-size="5">–°—Ä–µ–¥–Ω–∏–π</button>
                            <button class="brush-size-btn" data-size="10">–ö—Ä—É–ø–Ω—ã–π</button>
                        </div>
                        <div class="brush-preview" id="brushPreview" style="background: #000000; width: 10px; height: 10px;"></div>
                    </div>
                    
                    <div class="drawing-actions">
                        <button class="drawing-action-btn clear" id="clearPostDrawingBtn">–û—á–∏—Å—Ç–∏—Ç—å</button>
                    </div>
                </div>
            </div>
            
            <button class="post-btn" id="createPostBtn">–û–ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å</button>
        </div>

        <!-- –õ–µ–Ω—Ç–∞ –ø–æ—Å—Ç–æ–≤ -->
        <div id="feedSection">
            <div class="refresh-container">
                <button class="refresh-btn" id="refreshFeedBtn">–û–±–Ω–æ–≤–∏—Ç—å</button>
            </div>
            <div id="postsFeed"></div>
        </div>
    </div>

    <!-- –ù–∏–∂–Ω—è—è –Ω–∞–≤–∏–≥–∞—Ü–∏—è -->
    <div class="bottom-nav" id="bottomNav">
        <div class="nav-item active" data-nav="feed">
            <span>üè†</span>
            <span>–õ–µ–Ω—Ç–∞</span>
        </div>
        <div class="nav-item" data-nav="profile">
            <span>üë§</span>
            <span>–ü—Ä–æ—Ñ–∏–ª—å</span>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è —Ä–∏—Å–æ–≤–∞–Ω–∏—è –∞–≤–∞—Ç–∞—Ä–∞ -->
    <div class="modal" id="avatarDrawingModal">
        <div class="modal-content avatar-drawing-content">
            <h3>–ù–∞—Ä–∏—Å—É–π—Ç–µ –∞–≤–∞—Ç–∞—Ä</h3>
            
            <div class="avatar-preview-text">–†–∏—Å—É–π—Ç–µ –≤ –∫—Ä—É–≥–µ</div>
            
            <div class="avatar-drawing-canvas-wrapper">
                <canvas id="avatarDrawingCanvas" class="avatar-drawing-canvas" width="200" height="200"></canvas>
            </div>
            
            <div class="color-palette" style="margin-bottom: 1rem;">
                <button class="color-btn" style="background: #000000;" data-avatar-color="#000000"></button>
                <button class="color-btn" style="background: #ff4444;" data-avatar-color="#ff4444"></button>
                <button class="color-btn" style="background: #ff8800;" data-avatar-color="#ff8800"></button>
                <button class="color-btn" style="background: #ffdd44;" data-avatar-color="#ffdd44"></button>
                <button class="color-btn" style="background: #44ff44;" data-avatar-color="#44ff44"></button>
                <button class="color-btn" style="background: #44ddff;" data-avatar-color="#44ddff"></button>
                <button class="color-btn" style="background: #667eea;" data-avatar-color="#667eea"></button>
                <button class="color-btn" style="background: #aa44ff;" data-avatar-color="#aa44ff"></button>
                <button class="color-btn" style="background: #ff44aa;" data-avatar-color="#ff44aa"></button>
                <button class="color-btn" style="background: #ffffff;" data-avatar-color="#ffffff"></button>
            </div>
            
            <div class="brush-size-control" style="margin-bottom: 1rem;">
                <span style="color: #888;">–¢–æ–ª—â–∏–Ω–∞:</span>
                <div class="brush-size-buttons">
                    <button class="brush-size-btn" data-avatar-size="2">–ú–µ–ª–∫–∏–π</button>
                    <button class="brush-size-btn active" data-avatar-size="5">–°—Ä–µ–¥–Ω–∏–π</button>
                    <button class="brush-size-btn" data-avatar-size="10">–ö—Ä—É–ø–Ω—ã–π</button>
                </div>
            </div>
            
            <div class="drawing-actions">
                <button class="drawing-action-btn save" id="saveAvatarBtn">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
                <button class="drawing-action-btn clear" id="clearAvatarBtn">–û—á–∏—Å—Ç–∏—Ç—å</button>
                <button class="drawing-action-btn cancel" id="cancelAvatarBtn">–û—Ç–º–µ–Ω–∞</button>
            </div>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è —Ö–µ—à—Ç–µ–≥–æ–≤ -->
    <div class="modal hashtag-modal" id="hashtagModal">
        <div class="modal-content">
            <h3 id="hashtagModalTitle">#—Ö–µ—à—Ç–µ–≥</h3>
            <div class="hashtag-info">
                <div class="hashtag-name" id="hashtagName"></div>
                <div class="hashtag-count" id="hashtagCount">0</div>
                <div class="hashtag-label">–ø–æ—Å—Ç–æ–≤ —Å —ç—Ç–∏–º —Ç–µ–≥–æ–º</div>
            </div>
            <div class="hashtag-posts" id="hashtagPostsList"></div>
            <button class="drawing-action-btn cancel" style="width: 100%;" id="closeHashtagBtn">–ó–∞–∫—Ä—ã—Ç—å</button>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ —á—É–∂–æ–≥–æ –ø—Ä–æ—Ñ–∏–ª—è -->
    <div class="modal" id="userProfileModal">
        <div class="modal-content profile-modal-content">
            <h3 id="otherProfileName">–ü—Ä–æ—Ñ–∏–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</h3>
            
            <div class="profile-modal-header">
                <div class="profile-modal-avatar" id="otherProfileAvatar"></div>
                <div class="profile-modal-info">
                    <div class="profile-modal-name" id="otherProfileDisplayName"></div>
                    <div class="profile-modal-username" id="otherProfileUsername"></div>
                </div>
            </div>
            
            <div class="profile-modal-bio" id="otherProfileBio"></div>
            
            <div class="profile-modal-stats">
                <div class="stat">
                    <div class="stat-value" id="otherFollowersCount">0</div>
                    <div class="stat-label">–ø–æ–¥–ø–∏—Å—á–∏–∫–∏</div>
                </div>
                <div class="stat">
                    <div class="stat-value" id="otherFollowingCount">0</div>
                    <div class="stat-label">–ø–æ–¥–ø–∏—Å–∫–∏</div>
                </div>
                <div class="stat">
                    <div class="stat-value" id="otherTotalLikesCount">0</div>
                    <div class="stat-label">–ª–∞–π–∫–∏</div>
                </div>
            </div>
            
            <div class="profile-posts-section">
                <h4>–ü–æ—Å—Ç—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</h4>
                <div class="profile-posts-list" id="otherUserPosts"></div>
            </div>
            
            <div style="display: flex; gap: 0.5rem; margin-top: 1rem;">
                <button class="drawing-action-btn save" id="followFromProfileBtn">–ü–æ–¥–ø–∏—Å–∞—Ç—å—Å—è</button>
                <button class="drawing-action-btn cancel" id="closeProfileBtn">–ó–∞–∫—Ä—ã—Ç—å</button>
            </div>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è —Å–ø–∏—Å–∫–∞ –ø–æ–¥–ø–∏—Å—á–∏–∫–æ–≤ -->
    <div class="modal" id="followersModal">
        <div class="modal-content">
            <h3>–ü–æ–¥–ø–∏—Å—á–∏–∫–∏</h3>
            <div class="users-list" id="followersList"></div>
            <button class="drawing-action-btn cancel" style="width: 100%; margin-top: 1rem;" id="closeFollowersBtn">–ó–∞–∫—Ä—ã—Ç—å</button>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è —Å–ø–∏—Å–∫–∞ –ø–æ–¥–ø–∏—Å–æ–∫ -->
    <div class="modal" id="followingModal">
        <div class="modal-content">
            <h3>–ü–æ–¥–ø–∏—Å–∫–∏</h3>
            <div class="users-list" id="followingList"></div>
            <button class="drawing-action-btn cancel" style="width: 100%; margin-top: 1rem;" id="closeFollowingBtn">–ó–∞–∫—Ä—ã—Ç—å</button>
        </div>
    </div>

    <script src="script.js"></script>
</body>
</html>

    <script>
        // –î–∞–Ω–Ω—ã–µ
let users = JSON.parse(localStorage.getItem('void_users')) || [];
let posts = JSON.parse(localStorage.getItem('void_posts')) || [];
let comments = JSON.parse(localStorage.getItem('void_comments')) || [];
let commentLikes = JSON.parse(localStorage.getItem('void_commentLikes')) || [];
let postLikes = JSON.parse(localStorage.getItem('void_postLikes')) || [];
let subscriptions = JSON.parse(localStorage.getItem('void_subscriptions')) || [];
let currentUser = null;
let viewingUser = null;
let currentHashtag = null;

// –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ
function saveUsers() { localStorage.setItem('void_users', JSON.stringify(users)); }
function savePosts() { localStorage.setItem('void_posts', JSON.stringify(posts)); }
function saveComments() { localStorage.setItem('void_comments', JSON.stringify(comments)); }
function saveCommentLikes() { localStorage.setItem('void_commentLikes', JSON.stringify(commentLikes)); }
function savePostLikes() { localStorage.setItem('void_postLikes', JSON.stringify(postLikes)); }
function saveSubscriptions() { localStorage.setItem('void_subscriptions', JSON.stringify(subscriptions)); }

// –°–æ–∑–¥–∞–µ–º –¥–µ–º–æ-–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
if (users.length === 0) {
    users.push(
        {
            id: 'demo1',
            name: '–î–µ–º–æ',
            username: 'demo',
            bio: '–°–æ–∑–¥–∞—Ç–µ–ª—å Void ‚ú®',
            verified: true,
            avatar: null
        },
        {
            id: 'user1',
            name: '–ê–Ω–Ω–∞',
            username: 'anna',
            bio: '–î–∏–∑–∞–π–Ω–µ—Ä –∏ —Ö—É–¥–æ–∂–Ω–∏–∫ üé®',
            verified: false,
            avatar: null
        },
        {
            id: 'user2',
            name: '–ú–∞–∫—Å–∏–º',
            username: 'max',
            bio: '–†–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫ –∏–∑ Void üíª',
            verified: false,
            avatar: null
        },
        {
            id: 'user3',
            name: '–ï–ª–µ–Ω–∞',
            username: 'elena',
            bio: '–§–æ—Ç–æ–≥—Ä–∞—Ñ –∏ –ø—É—Ç–µ—à–µ—Å—Ç–≤–µ–Ω–Ω–∏—Ü–∞ üì∏',
            verified: false,
            avatar: null
        }
    );
    saveUsers();
}

// –°–æ–∑–¥–∞–µ–º —Ç–µ—Å—Ç–æ–≤—ã–µ –ø–æ—Å—Ç—ã
if (posts.length === 0) {
    posts.push(
        { 
            id: '101', 
            authorId: 'demo1', 
            content: '–í—Å–µ–º –ø—Ä–∏–≤–µ—Ç! üëã –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ Void! #–ø—Ä–∏–≤–µ—Ç #void', 
            hashtags: ['–ø—Ä–∏–≤–µ—Ç', 'void'],
            mentions: [],
            drawing: null,
            timestamp: Date.now() - 3600000 
        },
        { 
            id: '102', 
            authorId: 'user1', 
            content: '–°–µ–≥–æ–¥–Ω—è –æ—Ç–ª–∏—á–Ω–∞—è –ø–æ–≥–æ–¥–∞! ‚òÄÔ∏è #–ø–æ–≥–æ–¥–∞ #–ª–µ—Ç–æ', 
            hashtags: ['–ø–æ–≥–æ–¥–∞', '–ª–µ—Ç–æ'],
            mentions: [],
            drawing: null,
            timestamp: Date.now() - 7200000 
        },
        { 
            id: '103', 
            authorId: 'user2', 
            content: '–ù–æ–≤—ã–π –ø—Ä–æ–µ–∫—Ç –∑–∞–ø—É—â–µ–Ω! üöÄ #—Ä–∞–±–æ—Ç–∞ #–ø—Ä–æ–µ–∫—Ç', 
            hashtags: ['—Ä–∞–±–æ—Ç–∞', '–ø—Ä–æ–µ–∫—Ç'],
            mentions: [],
            drawing: null,
            timestamp: Date.now() - 10800000 
        },
        { 
            id: '104', 
            authorId: 'user3', 
            content: '–ú–æ–∏ –Ω–æ–≤—ã–µ —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏ —É–∂–µ –≤ –ø—Ä–æ—Ñ–∏–ª–µ üì∏ #—Ñ–æ—Ç–æ #—Ç–≤–æ—Ä—á–µ—Å—Ç–≤–æ', 
            hashtags: ['—Ñ–æ—Ç–æ', '—Ç–≤–æ—Ä—á–µ—Å—Ç–≤–æ'],
            mentions: [],
            drawing: null,
            timestamp: Date.now() - 14400000 
        }
    );
    savePosts();
}

// –§—É–Ω–∫—Ü–∏–∏
function getInitials(name) {
    return name.split(' ').map(n => n[0]).join('').toUpperCase().slice(0, 2);
}

function formatUsername(username) {
    return '@' + username;
}

function formatDate(timestamp) {
    const diff = Date.now() - timestamp;
    if (diff < 60000) return '—Ç–æ–ª—å–∫–æ —á—Ç–æ';
    if (diff < 3600000) return Math.floor(diff / 60000) + ' –º–∏–Ω –Ω–∞–∑–∞–¥';
    if (diff < 86400000) return Math.floor(diff / 3600000) + ' —á –Ω–∞–∑–∞–¥';
    return Math.floor(diff / 86400000) + ' –¥ –Ω–∞–∑–∞–¥';
}

function findUser(username) {
    return users.find(u => u.username.toLowerCase() === username.toLowerCase());
}

function findUserById(id) {
    return users.find(u => u.id === id);
}

function isValidUsername(username) {
    const regex = /^[a-zA-Z0-9_]{5,50}$/;
    return regex.test(username);
}

function extractHashtags(text) {
    return (text.match(/#[a-zA-Z–∞-—è–ê-–Ø0-9_]+/g) || []).map(tag => tag.substring(1));
}

function extractMentions(text) {
    return (text.match(/@[a-zA-Z0-9_]+/g) || []).map(mention => mention.substring(1));
}

function getTotalLikes(userId) {
    const userPosts = posts.filter(p => p.authorId === userId);
    let total = 0;
    userPosts.forEach(post => {
        total += postLikes.filter(l => l.postId === post.id).length;
    });
    return total;
}

function showNotification(message) {
    const toast = document.createElement('div');
    toast.className = 'notification-toast';
    toast.textContent = message;
    document.body.appendChild(toast);
    
    setTimeout(() => {
        toast.style.transform = 'translateX(-50%) translateY(100px)';
        setTimeout(() => toast.remove(), 300);
    }, 2000);
}

function updateUI() {
    if (!currentUser) return;

    // –û–±–Ω–æ–≤–ª—è–µ–º –∞–≤–∞—Ç–∞—Ä–∫—É
    const avatarEl = document.getElementById('profileAvatar');
    if (currentUser.avatar) {
        avatarEl.style.backgroundImage = `url('${currentUser.avatar}')`;
        avatarEl.classList.add('drawn-avatar');
        avatarEl.textContent = '';
    } else {
        avatarEl.style.backgroundImage = '';
        avatarEl.classList.remove('drawn-avatar');
        avatarEl.textContent = getInitials(currentUser.name);
    }

    document.getElementById('profileName').textContent = currentUser.name;
    document.getElementById('profileUsername').innerHTML = formatUsername(currentUser.username) + 
        (currentUser.verified ? ' <span class="verified-badge">‚úì</span>' : '');
    document.getElementById('profileBio').textContent = currentUser.bio || '–ü—Ä–∏–≤–µ—Ç! –Ø –≤ Void üëã';
    document.getElementById('currentUserName').textContent = currentUser.name;

    document.getElementById('editName').value = currentUser.name;
    document.getElementById('editUsername').value = currentUser.username;
    document.getElementById('editBio').value = currentUser.bio || '';

    const followers = subscriptions.filter(s => s.followingId === currentUser.id).length;
    const following = subscriptions.filter(s => s.followerId === currentUser.id).length;
    const totalLikes = getTotalLikes(currentUser.id);
    
    document.getElementById('followersCount').textContent = followers;
    document.getElementById('followingCount').textContent = following;
    document.getElementById('totalLikesCount').textContent = totalLikes;

    // –û–±–Ω–æ–≤–ª—è–µ–º –ª–µ–Ω—Ç—É
    updateFeed();
}

function updateFeed() {
    const feed = document.getElementById('postsFeed');
    
    if (posts.length === 0) {
        feed.innerHTML = '<div class="empty-state">–ü–æ–∫–∞ –Ω–µ—Ç –ø–æ—Å—Ç–æ–≤</div>';
        return;
    }

    feed.innerHTML = '';

    // –°–æ—Ä—Ç–∏—Ä—É–µ–º –ø–æ—Å—Ç—ã –ø–æ –≤—Ä–µ–º–µ–Ω–∏ (–Ω–æ–≤—ã–µ —Å–≤–µ—Ä—Ö—É)
    const sortedPosts = [...posts].sort((a, b) => b.timestamp - a.timestamp);

    sortedPosts.forEach(post => {
        const author = users.find(u => u.id === post.authorId);
        if (!author) return;

        const postComments = comments.filter(c => c.postId === post.id);
        const postLikesCount = postLikes.filter(l => l.postId === post.id).length;
        const userLikedPost = currentUser && postLikes.some(l => l.postId === post.id && l.userId === currentUser.id);

        const isFollowing = currentUser ? subscriptions.some(s => 
            s.followerId === currentUser.id && s.followingId === author.id
        ) : false;

        const postDiv = document.createElement('div');
        postDiv.className = 'post';
        
        // –§–æ—Ä–º–∏—Ä—É–µ–º HTML –¥–ª—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
        let postDrawingHTML = '';
        if (post.drawing) {
            postDrawingHTML = `<img src="${post.drawing}" class="post-drawing" loading="lazy">`;
        }

        // –§–æ—Ä–º–∏—Ä—É–µ–º HTML –¥–ª—è —Ö–µ—à—Ç–µ–≥–æ–≤
        let contentWithLinks = post.content;
        if (post.hashtags) {
            post.hashtags.forEach(tag => {
                const regex = new RegExp(`#${tag}`, 'g');
                contentWithLinks = contentWithLinks.replace(regex, `<span class="hashtag" onclick="openHashtagModal('${tag}')">#${tag}</span>`);
            });
        }
        if (post.mentions) {
            post.mentions.forEach(mention => {
                const regex = new RegExp(`@${mention}`, 'g');
                contentWithLinks = contentWithLinks.replace(regex, `<span class="mention" onclick="openUserProfile('${mention}')">@${mention}</span>`);
            });
        }

        // –§–æ—Ä–º–∏—Ä—É–µ–º HTML –¥–ª—è –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤
        const commentsHTML = postComments.map(c => {
            const commentAuthor = users.find(u => u.id === c.authorId);
            const commentLikesCount = commentLikes.filter(l => l.commentId === c.id).length;
            const userLikedComment = currentUser && commentLikes.some(l => l.commentId === c.id && l.userId === currentUser.id);
            const isCommentAuthor = currentUser && c.authorId === currentUser.id;
            
            return `
                <div class="comment">
                    <div class="comment-avatar ${commentAuthor?.avatar ? 'drawn-avatar' : ''}" ${commentAuthor?.avatar ? `style="background-image: url('${commentAuthor.avatar}')"` : ''} onclick="openUserProfile('${commentAuthor.username}')">${!commentAuthor?.avatar ? getInitials(commentAuthor?.name || '?') : ''}</div>
                    <div class="comment-content">
                        <div class="comment-header">
                            <span class="comment-author" onclick="openUserProfile('${commentAuthor.username}')">${commentAuthor?.name || '–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å'}</span>
                            ${isCommentAuthor ? `<span class="comment-delete-btn" onclick="deleteComment('${c.id}')">‚úï</span>` : ''}
                        </div>
                        <div class="comment-text">${c.text}</div>
                        <div class="comment-footer">
                            <span class="comment-like-btn ${userLikedComment ? 'liked' : ''}" onclick="toggleCommentLike('${c.id}')">
                                ‚ù§Ô∏è ${commentLikesCount}
                            </span>
                        </div>
                    </div>
                </div>
            `;
        }).join('');

        postDiv.innerHTML = `
            <div class="post-header" onclick="openUserProfile('${author.username}')">
                <div class="post-avatar ${author.avatar ? 'drawn-avatar' : ''}" ${author.avatar ? `style="background-image: url('${author.avatar}')"` : ''}>${!author.avatar ? getInitials(author.name) : ''}</div>
                <div class="post-author-info">
                    <div class="post-author">${author.name} ${author.verified ? '<span class="verified-badge">‚úì</span>' : ''}</div>
                    <div class="post-username">${formatUsername(author.username)}</div>
                </div>
                <div class="post-time">${formatDate(post.timestamp)}</div>
                ${author.id === currentUser?.id ? '<span class="delete-btn" onclick="deletePost(\'' + post.id + '\')">‚úï</span>' : ''}
            </div>
            <div class="post-content">${contentWithLinks.replace(/\n/g, '<br>')}</div>
            ${postDrawingHTML}
            <div class="post-actions">
                <span class="post-like-btn ${userLikedPost ? 'liked' : ''}" onclick="togglePostLike('${post.id}')">
                    ‚ù§Ô∏è ${postLikesCount}
                </span>
                <span class="comment-toggle" onclick="toggleComments('${post.id}')">üí¨ ${postComments.length}</span>
                ${author.id !== currentUser?.id ? `
                    <button class="follow-btn ${isFollowing ? 'following' : ''}" onclick="toggleFollow('${author.id}')">
                        ${isFollowing ? '‚úì –û—Ç–ø–∏—Å–∞—Ç—å—Å—è' : '+ –ü–æ–¥–ø–∏—Å–∞—Ç—å—Å—è'}
                    </button>
                ` : ''}
            </div>
            <div class="comments-section" id="comments-${post.id}">
                ${commentsHTML}
                ${currentUser ? `
                    <div class="add-comment">
                        <input type="text" placeholder="–ù–∞–ø–∏—Å–∞—Ç—å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π..." id="comment-input-${post.id}">
                        <button class="comment-submit" onclick="addComment('${post.id}')">‚Üí</button>
                    </div>
                ` : ''}
            </div>
        `;

        feed.appendChild(postDiv);
    });
}

function updateUserPosts() {
    const feed = document.getElementById('postsFeed');
    
    if (!currentUser) return;
    
    const userPosts = posts.filter(p => p.authorId === currentUser.id).sort((a, b) => b.timestamp - a.timestamp);
    
    if (userPosts.length === 0) {
        feed.innerHTML = '<div class="empty-state">–£ –≤–∞—Å –ø–æ–∫–∞ –Ω–µ—Ç –ø–æ—Å—Ç–æ–≤</div>';
        return;
    }

    feed.innerHTML = '';

    userPosts.forEach(post => {
        const author = currentUser;
        const postComments = comments.filter(c => c.postId === post.id);
        const postLikesCount = postLikes.filter(l => l.postId === post.id).length;
        const userLikedPost = currentUser && postLikes.some(l => l.postId === post.id && l.userId === currentUser.id);

        const postDiv = document.createElement('div');
        postDiv.className = 'post';
        
        // –§–æ—Ä–º–∏—Ä—É–µ–º HTML –¥–ª—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
        let postDrawingHTML = '';
        if (post.drawing) {
            postDrawingHTML = `<img src="${post.drawing}" class="post-drawing" loading="lazy">`;
        }

        // –§–æ—Ä–º–∏—Ä—É–µ–º HTML –¥–ª—è —Ö–µ—à—Ç–µ–≥–æ–≤
        let contentWithLinks = post.content;
        if (post.hashtags) {
            post.hashtags.forEach(tag => {
                const regex = new RegExp(`#${tag}`, 'g');
                contentWithLinks = contentWithLinks.replace(regex, `<span class="hashtag" onclick="openHashtagModal('${tag}')">#${tag}</span>`);
            });
        }
        if (post.mentions) {
            post.mentions.forEach(mention => {
                const regex = new RegExp(`@${mention}`, 'g');
                contentWithLinks = contentWithLinks.replace(regex, `<span class="mention" onclick="openUserProfile('${mention}')">@${mention}</span>`);
            });
        }

        // –§–æ—Ä–º–∏—Ä—É–µ–º HTML –¥–ª—è –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤
        const commentsHTML = postComments.map(c => {
            const commentAuthor = users.find(u => u.id === c.authorId);
            const commentLikesCount = commentLikes.filter(l => l.commentId === c.id).length;
            const userLikedComment = currentUser && commentLikes.some(l => l.commentId === c.id && l.userId === currentUser.id);
            const isCommentAuthor = currentUser && c.authorId === currentUser.id;
            
            return `
                <div class="comment">
                    <div class="comment-avatar ${commentAuthor?.avatar ? 'drawn-avatar' : ''}" ${commentAuthor?.avatar ? `style="background-image: url('${commentAuthor.avatar}')"` : ''} onclick="openUserProfile('${commentAuthor.username}')">${!commentAuthor?.avatar ? getInitials(commentAuthor?.name || '?') : ''}</div>
                    <div class="comment-content">
                        <div class="comment-header">
                            <span class="comment-author" onclick="openUserProfile('${commentAuthor.username}')">${commentAuthor?.name || '–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å'}</span>
                            ${isCommentAuthor ? `<span class="comment-delete-btn" onclick="deleteComment('${c.id}')">‚úï</span>` : ''}
                        </div>
                        <div class="comment-text">${c.text}</div>
                        <div class="comment-footer">
                            <span class="comment-like-btn ${userLikedComment ? 'liked' : ''}" onclick="toggleCommentLike('${c.id}')">
                                ‚ù§Ô∏è ${commentLikesCount}
                            </span>
                        </div>
                    </div>
                </div>
            `;
        }).join('');

        postDiv.innerHTML = `
            <div class="post-header">
                <div class="post-avatar ${author.avatar ? 'drawn-avatar' : ''}" ${author.avatar ? `style="background-image: url('${author.avatar}')"` : ''}>${!author.avatar ? getInitials(author.name) : ''}</div>
                <div class="post-author-info">
                    <div class="post-author">${author.name} ${author.verified ? '<span class="verified-badge">‚úì</span>' : ''}</div>
                    <div class="post-username">${formatUsername(author.username)}</div>
                </div>
                <div class="post-time">${formatDate(post.timestamp)}</div>
                <span class="delete-btn" onclick="deletePost('${post.id}')">‚úï</span>
            </div>
            <div class="post-content">${contentWithLinks.replace(/\n/g, '<br>')}</div>
            ${postDrawingHTML}
            <div class="post-actions">
                <span class="post-like-btn ${userLikedPost ? 'liked' : ''}" onclick="togglePostLike('${post.id}')">
                    ‚ù§Ô∏è ${postLikesCount}
                </span>
                <span class="comment-toggle" onclick="toggleComments('${post.id}')">üí¨ ${postComments.length}</span>
            </div>
            <div class="comments-section" id="comments-${post.id}">
                ${commentsHTML}
                ${currentUser ? `
                    <div class="add-comment">
                        <input type="text" placeholder="–ù–∞–ø–∏—Å–∞—Ç—å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π..." id="comment-input-${post.id}">
                        <button class="comment-submit" onclick="addComment('${post.id}')">‚Üí</button>
                    </div>
                ` : ''}
            </div>
        `;

        feed.appendChild(postDiv);
    });
}

// –ì–ª–æ–±–∞–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
window.toggleComments = function(postId) {
    const comments = document.getElementById(`comments-${postId}`);
    if (comments.style.display === 'block') {
        comments.style.display = 'none';
    } else {
        comments.style.display = 'block';
    }
};

window.addComment = function(postId) {
    const input = document.getElementById(`comment-input-${postId}`);
    const text = input.value.trim();
    
    if (!text || !currentUser) return;

    const newComment = {
        id: Date.now().toString(),
        postId: postId,
        authorId: currentUser.id,
        text: text,
        timestamp: Date.now()
    };

    comments.push(newComment);
    saveComments();
    input.value = '';
    
    const activeNav = document.querySelector('.nav-item.active')?.dataset.nav;
    if (activeNav === 'profile') {
        updateUserPosts();
    } else {
        updateFeed();
    }
};

window.deleteComment = function(commentId) {
    if (confirm('–£–¥–∞–ª–∏—Ç—å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π?')) {
        comments = comments.filter(c => c.id !== commentId);
        commentLikes = commentLikes.filter(l => l.commentId !== commentId);
        saveComments();
        saveCommentLikes();
        
        const activeNav = document.querySelector('.nav-item.active')?.dataset.nav;
        if (activeNav === 'profile') {
            updateUserPosts();
        } else {
            updateFeed();
        }
    }
};

window.toggleCommentLike = function(commentId) {
    if (!currentUser) return;
    
    const existing = commentLikes.find(l => l.commentId === commentId && l.userId === currentUser.id);
    
    if (existing) {
        commentLikes = commentLikes.filter(l => l.id !== existing.id);
    } else {
        commentLikes.push({
            id: Date.now().toString(),
            commentId: commentId,
            userId: currentUser.id,
            timestamp: Date.now()
        });
    }
    
    saveCommentLikes();
    
    const activeNav = document.querySelector('.nav-item.active')?.dataset.nav;
    if (activeNav === 'profile') {
        updateUserPosts();
    } else {
        updateFeed();
    }
};

window.togglePostLike = function(postId) {
    if (!currentUser) return;
    
    const existing = postLikes.find(l => l.postId === postId && l.userId === currentUser.id);
    
    if (existing) {
        postLikes = postLikes.filter(l => l.id !== existing.id);
    } else {
        postLikes.push({
            id: Date.now().toString(),
            postId: postId,
            userId: currentUser.id,
            timestamp: Date.now()
        });
    }
    
    savePostLikes();
    
    // –ù–∞—Ö–æ–¥–∏–º –∫–æ–Ω–∫—Ä–µ—Ç–Ω—É—é –∫–Ω–æ–ø–∫—É –∏ –æ–±–Ω–æ–≤–ª—è–µ–º –µ—ë
    const likeBtn = event.currentTarget;
    const count = postLikes.filter(l => l.postId === postId).length;
    likeBtn.innerHTML = `‚ù§Ô∏è ${count}`;
    likeBtn.classList.toggle('liked', !existing);
    
    // –û–±–Ω–æ–≤–ª—è–µ–º –æ–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ª–∞–π–∫–æ–≤ –≤ –ø—Ä–æ—Ñ–∏–ª–µ, –µ—Å–ª–∏ —ç—Ç–æ –Ω–∞—à –ø–æ—Å—Ç
    const post = posts.find(p => p.id === postId);
    if (post && post.authorId === currentUser.id) {
        const totalLikes = getTotalLikes(currentUser.id);
        document.getElementById('totalLikesCount').textContent = totalLikes;
    }
};

window.toggleFollow = function(userId) {
    const existing = subscriptions.find(s => s.followerId === currentUser.id && s.followingId === userId);
    
    if (existing) {
        subscriptions = subscriptions.filter(s => s.id !== existing.id);
        showNotification('–í—ã –æ—Ç–ø–∏—Å–∞–ª–∏—Å—å');
    } else {
        subscriptions.push({
            id: Date.now().toString(),
            followerId: currentUser.id,
            followingId: userId
        });
        showNotification('–í—ã –ø–æ–¥–ø–∏—Å–∞–ª–∏—Å—å');
    }
    
    saveSubscriptions();
    
    const activeNav = document.querySelector('.nav-item.active')?.dataset.nav;
    if (activeNav === 'profile') {
        updateUserPosts();
    } else {
        updateFeed();
    }
    
    // –û–±–Ω–æ–≤–ª—è–µ–º —Å—á–µ—Ç—á–∏–∫–∏ –≤ –ø—Ä–æ—Ñ–∏–ª–µ
    const followers = subscriptions.filter(s => s.followingId === currentUser.id).length;
    document.getElementById('followersCount').textContent = followers;
    const following = subscriptions.filter(s => s.followerId === currentUser.id).length;
    document.getElementById('followingCount').textContent = following;
};

window.deletePost = function(postId) {
    if (confirm('–£–¥–∞–ª–∏—Ç—å –ø–æ—Å—Ç?')) {
        posts = posts.filter(p => p.id !== postId);
        comments = comments.filter(c => c.postId !== postId);
        postLikes = postLikes.filter(l => l.postId !== postId);
        
        const commentIds = comments.filter(c => c.postId === postId).map(c => c.id);
        commentLikes = commentLikes.filter(l => !commentIds.includes(l.commentId));
        
        savePosts();
        saveComments();
        savePostLikes();
        saveCommentLikes();
        
        const activeNav = document.querySelector('.nav-item.active')?.dataset.nav;
        if (activeNav === 'profile') {
            updateUserPosts();
        } else {
            updateFeed();
        }
        updateUI();
    }
};

// –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ—Ç–∫—Ä—ã—Ç–∏—è –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ —Å —Ö–µ—à—Ç–µ–≥–æ–º
window.openHashtagModal = function(tag) {
    currentHashtag = tag;
    const hashtagPosts = posts.filter(p => p.hashtags && p.hashtags.includes(tag));
    
    document.getElementById('hashtagName').textContent = '#' + tag;
    document.getElementById('hashtagCount').textContent = hashtagPosts.length;
    
    const postsList = document.getElementById('hashtagPostsList');
    if (hashtagPosts.length === 0) {
        postsList.innerHTML = '<div class="empty-state">–ù–µ—Ç –ø–æ—Å—Ç–æ–≤ —Å —ç—Ç–∏–º —Ç–µ–≥–æ–º</div>';
    } else {
        postsList.innerHTML = hashtagPosts.map(post => {
            const author = users.find(u => u.id === post.authorId);
            return `
                <div class="hashtag-post-item" onclick="goToPost('${post.id}')">
                    <div class="hashtag-post-author">${author.name}</div>
                    <div class="hashtag-post-content">${post.content.substring(0, 100)}${post.content.length > 100 ? '...' : ''}</div>
                </div>
            `;
        }).join('');
    }
    
    document.getElementById('hashtagModal').style.display = 'flex';
};

window.goToPost = function(postId) {
    document.getElementById('hashtagModal').style.display = 'none';
    document.querySelector('[data-nav="feed"]').click();
    setTimeout(() => {
        const postElement = document.querySelector(`[onclick*="'${postId}'"]`)?.closest('.post');
        if (postElement) {
            postElement.scrollIntoView({ behavior: 'smooth', block: 'center' });
            postElement.style.transform = 'scale(1.02)';
            setTimeout(() => postElement.style.transform = '', 500);
            
            // –û—Ç–∫—Ä—ã–≤–∞–µ–º –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –∫ –ø–æ—Å—Ç—É
            const commentsSection = postElement.querySelector('.comments-section');
            if (commentsSection) {
                commentsSection.style.display = 'block';
            }
        }
    }, 100);
};

// –§—É–Ω–∫—Ü–∏–∏ –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –ø–æ–¥–ø–∏—Å—á–∏–∫–æ–≤ –∏ –ø–æ–¥–ø–∏—Å–æ–∫
window.showFollowers = function() {
    const followers = subscriptions.filter(s => s.followingId === currentUser.id);
    const followersList = document.getElementById('followersList');
    
    if (followers.length === 0) {
        followersList.innerHTML = '<div class="empty-state">–£ –≤–∞—Å –ø–æ–∫–∞ –Ω–µ—Ç –ø–æ–¥–ø–∏—Å—á–∏–∫–æ–≤</div>';
    } else {
        followersList.innerHTML = followers.map(sub => {
            const user = users.find(u => u.id === sub.followerId);
            if (!user) return '';
            return `
                <div class="user-item" onclick="openUserProfile('${user.username}')">
                    <div class="user-item-avatar ${user.avatar ? 'drawn-avatar' : ''}" ${user.avatar ? `style="background-image: url('${user.avatar}')"` : ''}>${!user.avatar ? getInitials(user.name) : ''}</div>
                    <div class="user-item-info">
                        <div class="user-item-name">${user.name}</div>
                        <div class="user-item-username">${formatUsername(user.username)}</div>
                    </div>
                </div>
            `;
        }).join('');
    }
    
    document.getElementById('followersModal').style.display = 'flex';
};

window.showFollowing = function() {
    const following = subscriptions.filter(s => s.followerId === currentUser.id);
    const followingList = document.getElementById('followingList');
    
    if (following.length === 0) {
        followingList.innerHTML = '<div class="empty-state">–í—ã –Ω–∏ –Ω–∞ –∫–æ–≥–æ –Ω–µ –ø–æ–¥–ø–∏—Å–∞–Ω—ã</div>';
    } else {
        followingList.innerHTML = following.map(sub => {
            const user = users.find(u => u.id === sub.followingId);
            if (!user) return '';
            return `
                <div class="user-item" onclick="openUserProfile('${user.username}')">
                    <div class="user-item-avatar ${user.avatar ? 'drawn-avatar' : ''}" ${user.avatar ? `style="background-image: url('${user.avatar}')"` : ''}>${!user.avatar ? getInitials(user.name) : ''}</div>
                    <div class="user-item-info">
                        <div class="user-item-name">${user.name}</div>
                        <div class="user-item-username">${formatUsername(user.username)}</div>
                    </div>
                </div>
            `;
        }).join('');
    }
    
    document.getElementById('followingModal').style.display = 'flex';
};

window.openUserProfile = function(username) {
    const user = findUser(username);
    if (!user || user.id === currentUser.id) {
        if (user && user.id === currentUser.id) {
            // –ï—Å–ª–∏ —ç—Ç–æ —Å–≤–æ–π –ø—Ä–æ—Ñ–∏–ª—å, –ø–µ—Ä–µ–∫–ª—é—á–∞–µ–º—Å—è –Ω–∞ –≤–∫–ª–∞–¥–∫—É –ø—Ä–æ—Ñ–∏–ª—è
            document.querySelector('[data-nav="profile"]').click();
        }
        return;
    }
    
    viewingUser = user;
    
    document.getElementById('otherProfileName').textContent = '–ü—Ä–æ—Ñ–∏–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è';
    document.getElementById('otherProfileDisplayName').textContent = user.name;
    document.getElementById('otherProfileUsername').textContent = formatUsername(user.username);
    document.getElementById('otherProfileBio').textContent = user.bio || '–ù–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏';
    
    const avatarEl = document.getElementById('otherProfileAvatar');
    if (user.avatar) {
        avatarEl.style.backgroundImage = `url('${user.avatar}')`;
        avatarEl.classList.add('drawn-avatar');
        avatarEl.textContent = '';
    } else {
        avatarEl.style.backgroundImage = '';
        avatarEl.classList.remove('drawn-avatar');
        avatarEl.textContent = getInitials(user.name);
    }
    
    const followers = subscriptions.filter(s => s.followingId === user.id).length;
    const following = subscriptions.filter(s => s.followerId === user.id).length;
    const totalLikes = getTotalLikes(user.id);
    
    document.getElementById('otherFollowersCount').textContent = followers;
    document.getElementById('otherFollowingCount').textContent = following;
    document.getElementById('otherTotalLikesCount').textContent = totalLikes;
    
    // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø–æ—Å—Ç—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    const userPosts = posts.filter(p => p.authorId === user.id).sort((a, b) => b.timestamp - a.timestamp);
    const postsList = document.getElementById('otherUserPosts');
    
    if (userPosts.length === 0) {
        postsList.innerHTML = '<div class="empty-state">–£ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø–æ–∫–∞ –Ω–µ—Ç –ø–æ—Å—Ç–æ–≤</div>';
    } else {
        postsList.innerHTML = userPosts.map(post => {
            const postLikesCount = postLikes.filter(l => l.postId === post.id).length;
            return `
                <div class="profile-post-item" onclick="goToPost('${post.id}')">
                    <div class="profile-post-content">${post.content.substring(0, 100)}${post.content.length > 100 ? '...' : ''}</div>
                    <div class="profile-post-stats">
                        <span>‚ù§Ô∏è ${postLikesCount}</span>
                        <span>üí¨ ${comments.filter(c => c.postId === post.id).length}</span>
                    </div>
                </div>
            `;
        }).join('');
    }
    
    const isFollowing = subscriptions.some(s => s.followerId === currentUser.id && s.followingId === user.id);
    document.getElementById('followFromProfileBtn').textContent = isFollowing ? '‚úì –û—Ç–ø–∏—Å–∞—Ç—å—Å—è' : '+ –ü–æ–¥–ø–∏—Å–∞—Ç—å—Å—è';
    
    document.getElementById('userProfileModal').style.display = 'flex';
};

// –†–∏—Å–æ–≤–∞–Ω–∏–µ –∞–≤–∞—Ç–∞—Ä–∞
let avatarCanvas, avatarCtx, avatarDrawing = false, avatarColor = '#000000', avatarBrushSize = 5;

window.openAvatarDrawing = function() {
    document.getElementById('avatarDrawingModal').style.display = 'flex';
    setTimeout(initAvatarCanvas, 100);
};

function initAvatarCanvas() {
    avatarCanvas = document.getElementById('avatarDrawingCanvas');
    avatarCtx = avatarCanvas.getContext('2d');
    
    // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –±–µ–ª—ã–π —Ñ–æ–Ω
    avatarCtx.fillStyle = '#ffffff';
    avatarCtx.fillRect(0, 0, avatarCanvas.width, avatarCanvas.height);
    
    avatarCanvas.addEventListener('mousedown', startAvatarDrawing);
    avatarCanvas.addEventListener('mousemove', drawAvatar);
    avatarCanvas.addEventListener('mouseup', stopAvatarDrawing);
    avatarCanvas.addEventListener('mouseleave', stopAvatarDrawing);
    
    avatarCanvas.addEventListener('touchstart', startAvatarDrawing);
    avatarCanvas.addEventListener('touchmove', drawAvatar);
    avatarCanvas.addEventListener('touchend', stopAvatarDrawing);
}

function startAvatarDrawing(e) {
    e.preventDefault();
    avatarDrawing = true;
    const pos = getAvatarCanvasCoordinates(e);
    avatarCtx.beginPath();
    avatarCtx.moveTo(pos.x, pos.y);
}

function drawAvatar(e) {
    e.preventDefault();
    if (!avatarDrawing) return;
    
    const pos = getAvatarCanvasCoordinates(e);
    avatarCtx.lineTo(pos.x, pos.y);
    avatarCtx.strokeStyle = avatarColor;
    avatarCtx.lineWidth = avatarBrushSize;
    avatarCtx.lineCap = 'round';
    avatarCtx.stroke();
    avatarCtx.beginPath();
    avatarCtx.moveTo(pos.x, pos.y);
}

function stopAvatarDrawing() {
    avatarDrawing = false;
}

function getAvatarCanvasCoordinates(e) {
    const rect = avatarCanvas.getBoundingClientRect();
    const scaleX = avatarCanvas.width / rect.width;
    const scaleY = avatarCanvas.height / rect.height;
    
    let clientX, clientY;
    if (e.touches) {
        clientX = e.touches[0].clientX;
        clientY = e.touches[0].clientY;
    } else {
        clientX = e.clientX;
        clientY = e.clientY;
    }
    
    return {
        x: (clientX - rect.left) * scaleX,
        y: (clientY - rect.top) * scaleY
    };
}

function clearAvatarCanvas() {
    if (avatarCtx) {
        avatarCtx.fillStyle = '#ffffff';
        avatarCtx.fillRect(0, 0, avatarCanvas.width, avatarCanvas.height);
    }
}

// –†–∏—Å–æ–≤–∞–Ω–∏–µ –¥–ª—è –ø–æ—Å—Ç–∞
let postCanvas, postCtx, postDrawing = false, postColor = '#000000', postBrushSize = 5;

function initPostCanvas() {
    postCanvas = document.getElementById('postDrawingCanvas');
    if (!postCanvas) return;
    
    postCtx = postCanvas.getContext('2d');
    
    // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –±–µ–ª—ã–π —Ñ–æ–Ω
    postCtx.fillStyle = '#ffffff';
    postCtx.fillRect(0, 0, postCanvas.width, postCanvas.height);
    
    postCanvas.addEventListener('mousedown', startPostDrawing);
    postCanvas.addEventListener('mousemove', drawPost);
    postCanvas.addEventListener('mouseup', stopPostDrawing);
    postCanvas.addEventListener('mouseleave', stopPostDrawing);
    
    postCanvas.addEventListener('touchstart', startPostDrawing);
    postCanvas.addEventListener('touchmove', drawPost);
    postCanvas.addEventListener('touchend', stopPostDrawing);
}

function startPostDrawing(e) {
    e.preventDefault();
    postDrawing = true;
    const pos = getPostCanvasCoordinates(e);
    postCtx.beginPath();
    postCtx.moveTo(pos.x, pos.y);
}

function drawPost(e) {
    e.preventDefault();
    if (!postDrawing) return;
    
    const pos = getPostCanvasCoordinates(e);
    postCtx.lineTo(pos.x, pos.y);
    postCtx.strokeStyle = postColor;
    postCtx.lineWidth = postBrushSize;
    postCtx.lineCap = 'round';
    postCtx.stroke();
    postCtx.beginPath();
    postCtx.moveTo(pos.x, pos.y);
}

function stopPostDrawing() {
    postDrawing = false;
}

function getPostCanvasCoordinates(e) {
    const rect = postCanvas.getBoundingClientRect();
    const scaleX = postCanvas.width / rect.width;
    const scaleY = postCanvas.height / rect.height;
    
    let clientX, clientY;
    if (e.touches) {
        clientX = e.touches[0].clientX;
        clientY = e.touches[0].clientY;
    } else {
        clientX = e.clientX;
        clientY = e.clientY;
    }
    
    return {
        x: (clientX - rect.left) * scaleX,
        y: (clientY - rect.top) * scaleY
    };
}

function clearPostCanvas() {
    if (postCtx) {
        postCtx.fillStyle = '#ffffff';
        postCtx.fillRect(0, 0, postCanvas.width, postCanvas.height);
    }
}

function updateBrushPreview() {
    const preview = document.getElementById('brushPreview');
    if (preview) {
        preview.style.background = postColor;
        preview.style.width = postBrushSize * 2 + 'px';
        preview.style.height = postBrushSize * 2 + 'px';
    }
}

// –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
document.addEventListener('DOMContentLoaded', function() {
    console.log('‚úÖ Void –∑–∞–≥—Ä—É–∂–µ–Ω');
    
    // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤—Ö–æ–¥–∏–º –≤ –¥–µ–º–æ-–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    currentUser = users[0];
    
    // –û–±–Ω–æ–≤–ª—è–µ–º UI
    document.getElementById('userInfo').style.display = 'flex';
    updateUI();

    // –ü–æ–ª—É—á–∞–µ–º —ç–ª–µ–º–µ–Ω—Ç—ã
    const themeIcon = document.getElementById('themeIcon');
    const logoutBtn = document.getElementById('logoutBtn');
    const createPostBtn = document.getElementById('createPostBtn');
    const editProfileBtn = document.getElementById('editProfileBtn');
    const cancelEditBtn = document.getElementById('cancelEditBtn');
    const saveProfileBtn = document.getElementById('saveProfileBtn');
    const hashtagBtn = document.getElementById('hashtagBtn');
    const drawingBtn = document.getElementById('drawingBtn');
    const refreshFeedBtn = document.getElementById('refreshFeedBtn');
    const navItems = document.querySelectorAll('.nav-item');
    const clearPostDrawingBtn = document.getElementById('clearPostDrawingBtn');
    const newAvatarBtn = document.getElementById('newAvatarBtn');
    const deleteAvatarBtn = document.getElementById('deleteAvatarBtn');
    
    // –≠–ª–µ–º–µ–Ω—Ç—ã –¥–ª—è —Ä–∏—Å–æ–≤–∞–Ω–∏—è –∞–≤–∞—Ç–∞—Ä–∞
    const saveAvatarBtn = document.getElementById('saveAvatarBtn');
    const cancelAvatarBtn = document.getElementById('cancelAvatarBtn');
    const clearAvatarBtn = document.getElementById('clearAvatarBtn');
    
    // –≠–ª–µ–º–µ–Ω—Ç—ã –¥–ª—è —Ö–µ—à—Ç–µ–≥–æ–≤
    const closeHashtagBtn = document.getElementById('closeHashtagBtn');
    
    // –≠–ª–µ–º–µ–Ω—Ç—ã –¥–ª—è –ø—Ä–æ—Ñ–∏–ª—è
    const closeProfileBtn = document.getElementById('closeProfileBtn');
    const followFromProfileBtn = document.getElementById('followFromProfileBtn');
    
    // –≠–ª–µ–º–µ–Ω—Ç—ã –¥–ª—è –ø–æ–¥–ø–∏—Å—á–∏–∫–æ–≤ –∏ –ø–æ–¥–ø–∏—Å–æ–∫
    const closeFollowersBtn = document.getElementById('closeFollowersBtn');
    const closeFollowingBtn = document.getElementById('closeFollowingBtn');

    // –ù–∏–∂–Ω—è—è –Ω–∞–≤–∏–≥–∞—Ü–∏—è
    navItems.forEach(item => {
        item.addEventListener('click', function() {
            const nav = this.dataset.nav;
            
            navItems.forEach(n => n.classList.remove('active'));
            this.classList.add('active');
            
            document.getElementById('profileSection').style.display = 'none';
            document.getElementById('createPostSection').style.display = 'none';
            document.getElementById('feedSection').style.display = 'none';
            document.getElementById('editProfileForm').style.display = 'none';
            document.getElementById('avatarActions').style.display = 'none';
            
            if (nav === 'feed') {
                document.getElementById('feedSection').style.display = 'block';
                updateFeed();
            } else if (nav === 'profile') {
                document.getElementById('profileSection').style.display = 'block';
                document.getElementById('createPostSection').style.display = 'block';
                updateUserPosts();
            }
        });
    });

    // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ª–µ–Ω—Ç—ã
    if (refreshFeedBtn) {
        refreshFeedBtn.onclick = function() {
            updateFeed();
            showNotification('–õ–µ–Ω—Ç–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∞');
        };
    }

    // –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª—è
    if (editProfileBtn) {
        editProfileBtn.onclick = function() {
            document.getElementById('profileSection').style.display = 'none';
            document.getElementById('createPostSection').style.display = 'none';
            document.getElementById('editProfileForm').style.display = 'block';
            document.getElementById('avatarActions').style.display = 'flex';
            
            document.getElementById('editName').value = currentUser.name;
            document.getElementById('editUsername').value = currentUser.username;
            document.getElementById('editBio').value = currentUser.bio || '';
        };
    }

    if (cancelEditBtn) {
        cancelEditBtn.onclick = function() {
            document.getElementById('editProfileForm').style.display = 'none';
            document.getElementById('profileSection').style.display = 'block';
            document.getElementById('createPostSection').style.display = 'block';
            document.getElementById('avatarActions').style.display = 'none';
        };
    }

    // –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∞–≤–∞—Ç–∞—Ä–∫–æ–π
    if (newAvatarBtn) {
        newAvatarBtn.onclick = openAvatarDrawing;
    }

    if (deleteAvatarBtn) {
        deleteAvatarBtn.onclick = function() {
            if (confirm('–£–¥–∞–ª–∏—Ç—å –∞–≤–∞—Ç–∞—Ä?')) {
                currentUser.avatar = null;
                const userIndex = users.findIndex(u => u.id === currentUser.id);
                if (userIndex !== -1) {
                    users[userIndex].avatar = null;
                    saveUsers();
                }
                updateUI();
                showNotification('–ê–≤–∞—Ç–∞—Ä —É–¥–∞–ª–µ–Ω');
            }
        };
    }

    // –†–∏—Å–æ–≤–∞–Ω–∏–µ –¥–ª—è –ø–æ—Å—Ç–∞
    if (drawingBtn) {
        drawingBtn.onclick = function() {
            const container = document.getElementById('drawingContainer');
            if (container.style.display === 'none' || container.style.display === '') {
                container.style.display = 'block';
                setTimeout(() => {
                    initPostCanvas();
                    // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ü–≤–µ—Ç–∞ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
                    document.querySelector('.color-btn[data-color="#000000"]').classList.add('active');
                    document.querySelector('.brush-size-btn[data-size="5"]').classList.add('active');
                    updateBrushPreview();
                }, 100);
            } else {
                container.style.display = 'none';
            }
        };
    }

    // –¶–≤–µ—Ç–∞ –¥–ª—è —Ä–∏—Å–æ–≤–∞–Ω–∏—è –ø–æ—Å—Ç–∞
    document.querySelectorAll('.color-btn[data-color]').forEach(btn => {
        btn.addEventListener('click', function() {
            postColor = this.dataset.color;
            document.querySelectorAll('.color-btn').forEach(b => b.classList.remove('active'));
            this.classList.add('active');
            updateBrushPreview();
        });
    });

    // –†–∞–∑–º–µ—Ä –∫–∏—Å—Ç–∏ –¥–ª—è –ø–æ—Å—Ç–∞
    document.querySelectorAll('.brush-size-btn[data-size]').forEach(btn => {
        btn.addEventListener('click', function() {
            postBrushSize = parseInt(this.dataset.size);
            document.querySelectorAll('.brush-size-btn').forEach(b => b.classList.remove('active'));
            this.classList.add('active');
            updateBrushPreview();
        });
    });

    // –û—á–∏—Å—Ç–∫–∞ —Ä–∏—Å—É–Ω–∫–∞ –ø–æ—Å—Ç–∞
    if (clearPostDrawingBtn) {
        clearPostDrawingBtn.onclick = clearPostCanvas;
    }

    // –¶–≤–µ—Ç–∞ –¥–ª—è –∞–≤–∞—Ç–∞—Ä–∞
    document.querySelectorAll('[data-avatar-color]').forEach(btn => {
        btn.addEventListener('click', function() {
            avatarColor = this.dataset.avatarColor;
            document.querySelectorAll('[data-avatar-color]').forEach(b => b.classList.remove('active'));
            this.classList.add('active');
        });
    });

    // –†–∞–∑–º–µ—Ä –∫–∏—Å—Ç–∏ –¥–ª—è –∞–≤–∞—Ç–∞—Ä–∞
    document.querySelectorAll('[data-avatar-size]').forEach(btn => {
        btn.addEventListener('click', function() {
            avatarBrushSize = parseInt(this.dataset.avatarSize);
            document.querySelectorAll('[data-avatar-size]').forEach(b => b.classList.remove('active'));
            this.classList.add('active');
        });
    });

    if (clearAvatarBtn) {
        clearAvatarBtn.onclick = clearAvatarCanvas;
    }

    // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∞–≤–∞—Ç–∞—Ä–∞
    if (saveAvatarBtn) {
        saveAvatarBtn.onclick = function() {
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –Ω–µ –ø—É—Å—Ç–æ–π –ª–∏ —Ä–∏—Å—É–Ω–æ–∫
            const imageData = avatarCtx.getImageData(0, 0, avatarCanvas.width, avatarCanvas.height).data;
            let hasDrawing = false;
            for (let i = 0; i < imageData.length; i += 4) {
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –æ—Ç–ª–∏—á–∞–µ—Ç—Å—è –ª–∏ –ø–∏–∫—Å–µ–ª—å –æ—Ç –±–µ–ª–æ–≥–æ
                if (imageData[i] < 250 || imageData[i+1] < 250 || imageData[i+2] < 250) {
                    hasDrawing = true;
                    break;
                }
            }
            
            if (hasDrawing) {
                // –°–æ–∑–¥–∞–µ–º –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ —Ä–∞–∑–º–µ—Ä–∞ –¥–ª—è –∞–≤–∞—Ç–∞—Ä–∞
                const tempCanvas = document.createElement('canvas');
                tempCanvas.width = 200;
                tempCanvas.height = 200;
                const tempCtx = tempCanvas.getContext('2d');
                
                // –†–∏—Å—É–µ–º –±–µ–ª—ã–π —Ñ–æ–Ω
                tempCtx.fillStyle = '#ffffff';
                tempCtx.fillRect(0, 0, 200, 200);
                
                // –†–∏—Å—É–µ–º —Ä–∏—Å—É–Ω–æ–∫ —Å –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ–º
                tempCtx.drawImage(avatarCanvas, 0, 0, 200, 200);
                
                const avatarData = tempCanvas.toDataURL('image/png');
                currentUser.avatar = avatarData;
                
                const userIndex = users.findIndex(u => u.id === currentUser.id);
                if (userIndex !== -1) {
                    users[userIndex].avatar = avatarData;
                    saveUsers();
                }
                
                document.getElementById('avatarDrawingModal').style.display = 'none';
                updateUI();
                showNotification('–ê–≤–∞—Ç–∞—Ä —Å–æ—Ö—Ä–∞–Ω–µ–Ω');
            } else {
                showNotification('–ù–∞—Ä–∏—Å—É–π—Ç–µ —á—Ç–æ-–Ω–∏–±—É–¥—å');
            }
        };
    }

    if (cancelAvatarBtn) {
        cancelAvatarBtn.onclick = function() {
            document.getElementById('avatarDrawingModal').style.display = 'none';
        };
    }

    // –ó–∞–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª—å–Ω—ã—Ö –æ–∫–æ–Ω
    if (closeHashtagBtn) {
        closeHashtagBtn.onclick = function() {
            document.getElementById('hashtagModal').style.display = 'none';
        };
    }

    if (closeProfileBtn) {
        closeProfileBtn.onclick = function() {
            document.getElementById('userProfileModal').style.display = 'none';
        };
    }

    if (closeFollowersBtn) {
        closeFollowersBtn.onclick = function() {
            document.getElementById('followersModal').style.display = 'none';
        };
    }

    if (closeFollowingBtn) {
        closeFollowingBtn.onclick = function() {
            document.getElementById('followingModal').style.display = 'none';
        };
    }

    if (followFromProfileBtn) {
        followFromProfileBtn.onclick = function() {
            if (viewingUser) {
                const existing = subscriptions.find(s => s.followerId === currentUser.id && s.followingId === viewingUser.id);
                
                if (existing) {
                    subscriptions = subscriptions.filter(s => s.id !== existing.id);
                    this.textContent = '+ –ü–æ–¥–ø–∏—Å–∞—Ç—å—Å—è';
                    showNotification('–í—ã –æ—Ç–ø–∏—Å–∞–ª–∏—Å—å');
                } else {
                    subscriptions.push({
                        id: Date.now().toString(),
                        followerId: currentUser.id,
                        followingId: viewingUser.id
                    });
                    this.textContent = '‚úì –û—Ç–ø–∏—Å–∞—Ç—å—Å—è';
                    showNotification('–í—ã –ø–æ–¥–ø–∏—Å–∞–ª–∏—Å—å');
                }
                
                saveSubscriptions();
                
                const followers = subscriptions.filter(s => s.followingId === viewingUser.id).length;
                document.getElementById('otherFollowersCount').textContent = followers;
                const following = subscriptions.filter(s => s.followerId === viewingUser.id).length;
                document.getElementById('otherFollowingCount').textContent = following;
            }
        };
    }

    // –ó–∞–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª—å–Ω—ã—Ö –æ–∫–æ–Ω –ø–æ –∫–ª–∏–∫—É –≤–Ω–µ
    document.querySelectorAll('.modal').forEach(modal => {
        modal.addEventListener('click', function(e) {
            if (e.target === modal) {
                modal.style.display = 'none';
            }
        });
    });

    // –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ö–µ—à—Ç–µ–≥–∞
    if (hashtagBtn) {
        hashtagBtn.onclick = function() {
            const textarea = document.getElementById('postContent');
            textarea.value += ' #';
            textarea.focus();
        };
    }

    // –í—ã—Ö–æ–¥
    if (logoutBtn) {
        logoutBtn.onclick = function() {
            if (confirm('–í—ã–π—Ç–∏ –∏–∑ –∞–∫–∫–∞—É–Ω—Ç–∞?')) {
                localStorage.clear();
                location.reload();
            }
        };
    }

    // –°–æ–∑–¥–∞–Ω–∏–µ –ø–æ—Å—Ç–∞
    if (createPostBtn) {
        createPostBtn.onclick = function() {
            const content = document.getElementById('postContent').value.trim();
            
            let drawingData = null;
            if (postCanvas) {
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –Ω–µ –ø—É—Å—Ç–æ–π –ª–∏ —Ä–∏—Å—É–Ω–æ–∫
                const imageData = postCtx.getImageData(0, 0, postCanvas.width, postCanvas.height).data;
                let hasDrawing = false;
                for (let i = 0; i < imageData.length; i += 4) {
                    // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –æ—Ç–ª–∏—á–∞–µ—Ç—Å—è –ª–∏ –ø–∏–∫—Å–µ–ª—å –æ—Ç –±–µ–ª–æ–≥–æ
                    if (imageData[i] < 250 || imageData[i+1] < 250 || imageData[i+2] < 250) {
                        hasDrawing = true;
                        break;
                    }
                }
                
                if (hasDrawing) {
                    drawingData = postCanvas.toDataURL('image/png');
                }
            }
            
            if (!content && !drawingData) {
                alert('–î–æ–±–∞–≤—å—Ç–µ —Ç–µ–∫—Å—Ç –∏–ª–∏ —Ä–∏—Å—É–Ω–æ–∫');
                return;
            }

            const hashtags = extractHashtags(content);
            const mentions = extractMentions(content);

            const newPost = {
                id: Date.now().toString(),
                authorId: currentUser.id,
                content: content || '',
                drawing: drawingData,
                hashtags: hashtags,
                mentions: mentions,
                timestamp: Date.now()
            };

            posts.push(newPost);
            savePosts();
            
            document.getElementById('postContent').value = '';
            document.getElementById('drawingContainer').style.display = 'none';
            clearPostCanvas();
            
            updateUserPosts();
            updateUI();
            showNotification('–ü–æ—Å—Ç –æ–ø—É–±–ª–∏–∫–æ–≤–∞–Ω');
        };
    }

    // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª—è
    if (saveProfileBtn) {
        saveProfileBtn.onclick = function() {
            const newName = document.getElementById('editName').value.trim();
            const newUsername = document.getElementById('editUsername').value.trim();
            const newBio = document.getElementById('editBio').value.trim();

            if (!newName || !newUsername) {
                alert('–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –∏–º—è –∏ —é–∑–µ—Ä–Ω–µ–π–º');
                return;
            }

            if (!isValidUsername(newUsername)) {
                alert('–Æ–∑–µ—Ä–Ω–µ–π–º –¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å —Ç–æ–ª—å–∫–æ –ª–∞—Ç–∏–Ω—Å–∫–∏–µ –±—É–∫–≤—ã, —Ü–∏—Ñ—Ä—ã –∏ –Ω–∏–∂–Ω–µ–µ –ø–æ–¥—á–µ—Ä–∫–∏–≤–∞–Ω–∏–µ (–æ—Ç 5 –¥–æ 50 —Å–∏–º–≤–æ–ª–æ–≤)');
                return;
            }

            const cleanUsername = newUsername.toLowerCase();
            const existingUser = users.find(u => u.username === cleanUsername && u.id !== currentUser.id);
            
            if (existingUser) {
                alert('–Æ–∑–µ—Ä–Ω–µ–π–º –∑–∞–Ω—è—Ç');
                return;
            }

            currentUser.name = newName;
            currentUser.username = cleanUsername;
            currentUser.bio = newBio;

            const index = users.findIndex(u => u.id === currentUser.id);
            if (index !== -1) users[index] = currentUser;
            saveUsers();

            document.getElementById('editProfileForm').style.display = 'none';
            document.getElementById('profileSection').style.display = 'block';
            document.getElementById('createPostSection').style.display = 'block';
            document.getElementById('avatarActions').style.display = 'none';
            updateUI();
            showNotification('–ü—Ä–æ—Ñ–∏–ª—å –æ–±–Ω–æ–≤–ª–µ–Ω');
        };
    }

    // –¢–µ–º–∞
    if (themeIcon) {
        themeIcon.onclick = function() {
            document.body.classList.toggle('light-theme');
            this.textContent = document.body.classList.contains('light-theme') ? '‚òÄÔ∏è' : 'üåô';
            localStorage.setItem('void_theme', document.body.classList.contains('light-theme') ? 'light' : 'dark');
            
            // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∏–ª–∏
            const activeNav = document.querySelector('.nav-item.active')?.dataset.nav;
            if (activeNav === 'profile') {
                updateUserPosts();
            } else {
                updateFeed();
            }
        };
    }

    // –ó–∞–≥—Ä—É–∂–∞–µ–º —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—É—é —Ç–µ–º—É
    const savedTheme = localStorage.getItem('void_theme');
    if (savedTheme === 'light') {
        document.body.classList.add('light-theme');
        themeIcon.textContent = '‚òÄÔ∏è';
    }

    // –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –ª–µ–Ω—Ç—É
    document.querySelector('[data-nav="feed"]').click();
});
    </script>
</body>
</html>